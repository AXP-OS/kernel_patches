From 346c968dd8ec451d052b49064d2760905e45c7e6 Mon Sep 17 00:00:00 2001
From: "David S. Miller" <davem@davemloft.net>
Date: Tue, 15 Dec 2015 15:39:08 -0500
Subject: [PATCH] bluetooth: Validate socket address length in sco_sock_bind().

Change-Id: I6507f5da40eaff53fbc42512dce342a9724b3d9b
Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-8575
Signed-off-by: Kevin F. Haggerty <haggertk@lineageos.org>
---
 net/bluetooth/sco.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/net/bluetooth/sco.c b/net/bluetooth/sco.c
index ba178d6402b..d1fb5d21e37 100644
--- a/net/bluetooth/sco.c
+++ b/net/bluetooth/sco.c
@@ -500,6 +500,9 @@ static int sco_sock_bind(struct socket *sock, struct sockaddr *addr, int alen)
 	if (!addr || addr->sa_family != AF_BLUETOOTH)
 		return -EINVAL;
 
+	if (alen < sizeof(struct sockaddr_sco))
+		return -EINVAL;
+
 	memset(&sa, 0, sizeof(sa));
 	len = min_t(unsigned int, sizeof(sa), alen);
 	memcpy(&sa, addr, len);
