From 5bb0059243515ecdac138cfdb4cee7259bbd0bbc Mon Sep 17 00:00:00 2001
From: Subrat Dash <sdash@qti.qualcomm.com>
Date: Wed, 3 Aug 2016 16:47:39 +0530
Subject: qcacld-2.0: Fix VHT-80 IBSS stops beaconing

A STA entry is created for each peer joining
the network to take care of the peer specific
capabilities.

The VDEV need not be reconfigured for IBSS peer
with different channel width joining the network.

Change-Id: Iec6ec5d2b510b84538f4e5300b3f1c5cc63b334d
CRs-Fixed: 1046409
---
 CORE/MAC/src/pe/sch/schBeaconProcess.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/CORE/MAC/src/pe/sch/schBeaconProcess.c b/CORE/MAC/src/pe/sch/schBeaconProcess.c
index a28f2be..4ed8aea 100644
--- a/CORE/MAC/src/pe/sch/schBeaconProcess.c
+++ b/CORE/MAC/src/pe/sch/schBeaconProcess.c
@@ -465,7 +465,8 @@ static void __schBeaconProcessForSession( tpAniSirGlobal      pMac,
             sendProbeReq = TRUE;
     }
 
-    if ( psessionEntry->htCapability && pBeacon->HTInfo.present )
+    if (psessionEntry->htCapability && pBeacon->HTInfo.present &&
+                                 (!LIM_IS_IBSS_ROLE(psessionEntry)))
     {
         limUpdateStaRunTimeHTSwitchChnlParams( pMac, &pBeacon->HTInfo, bssIdx,psessionEntry);
     }
-- 
cgit v1.1

