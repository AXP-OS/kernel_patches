From a0e05f77f42540401c7a1e4d9a142891a6680e66 Mon Sep 17 00:00:00 2001
From: Siena Richard <sienar@codeaurora.org>
Date: Tue, 16 Aug 2016 13:03:56 -0700
Subject: [PATCH] misc: qcom: qdsp6v2: initialize wma_config

Not all memebers of wma_config are set before they are used which
might lead to invalid values being passed and used. To fix this issue
initialize all member variables of struct wma_config to 0 before
assigning specific values individually.

Change-Id: Ibb082ce691625527e9a9ffd4978dea7ba4df9e84
CRs-Fixed: 1054352
Signed-off-by: Siena Richard <sienar@codeaurora.org>
CVE-2016-3907
Signed-off-by: Kevin F. Haggerty <haggertk@lineageos.org>
---
 arch/arm/mach-msm/qdsp6v2/audio_wma.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/arm/mach-msm/qdsp6v2/audio_wma.c b/arch/arm/mach-msm/qdsp6v2/audio_wma.c
index 5a64a698b80..2f8df45240f 100644
--- a/arch/arm/mach-msm/qdsp6v2/audio_wma.c
+++ b/arch/arm/mach-msm/qdsp6v2/audio_wma.c
@@ -47,6 +47,8 @@ static long audio_ioctl(struct file *file, unsigned int cmd, unsigned long arg)
 				break;
 			}
 		}
+		memset(&wma_config, 0, sizeof(wma_config));
+
 		wma_config = (struct msm_audio_wma_config_v2 *)audio->codec_cfg;
 		wma_cfg.format_tag = wma_config->format_tag;
 		wma_cfg.ch_cfg = wma_config->numchannels;
