diff --git a/security/keys/key.c b/security/keys/key.c
index 06783cf..5f9902e 100644
--- a/security/keys/key.c
+++ b/security/keys/key.c
@@ -573,7 +573,7 @@
 
 	mutex_unlock(&key_construction_mutex);
 
-	if (keyring)
+	if (keyring && link_ret == 0)
 		__key_link_end(keyring, key->type, prealloc);
 
 	/* wake up anyone waiting for a key to be constructed */
