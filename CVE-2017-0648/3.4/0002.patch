From ae34ac85c8f179dc807cfd2a32b8f514d6cf4ea9 Mon Sep 17 00:00:00 2001
From: Mark Salyzyn <salyzyn@google.com>
Date: Mon, 27 Mar 2017 14:17:00 -0700
Subject: [PATCH] sysrq: FIQ and sysrq default deauthorized

(cherry picked from commit c6389b11ae779d9f360d2c6555037e1d73c0fe1b)

Signed-off-by: Mark Salyzyn <salyzyn@google.com>
Bug: 36101220
Change-Id: I9f0ae9a9e3828dedf4b933bf1d752c98777cfa91
CVE-2017-0648
Signed-off-by: Kevin F. Haggerty <haggertk@lineageos.org>
---
 include/linux/sysrq.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/include/linux/sysrq.h b/include/linux/sysrq.h
index 5a0bd938c6a..d393eeb476c 100644
--- a/include/linux/sysrq.h
+++ b/include/linux/sysrq.h
@@ -18,7 +18,7 @@
 #include <linux/types.h>
 
 /* Enable/disable SYSRQ support by default (0==no, 1==yes). */
-#define SYSRQ_DEFAULT_ENABLE	1
+#define SYSRQ_DEFAULT_ENABLE	0
 
 /* Possible values of bitmask for enabling sysrq functions */
 /* 0x0001 is reserved for enable everything */
