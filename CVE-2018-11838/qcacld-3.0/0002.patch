From 815cf7b4de9bfe7ed77a04db5c3462d5a29b8e43 Mon Sep 17 00:00:00 2001
From: gaurank kathpalia <gkathpal@codeaurora.org>
Date: Fri, 11 May 2018 15:42:30 +0530
Subject: qcacld-3.0: Fix memory double free condition in wma_roam_update_vdev

The driver allocates memory to del_sta_params in API
wma_roam_update_vdev. In the call of wma_delete_sta API
the driver does mem-free for del_sta_params
But in the main API wma_roam_update_vdev, after the function call
of wma_delete_sta, the driver does mem-free again, which could
mem free of memory block allocated to some other block.

Fix is to remove the mem-free of del_sta_params
in API wma_roam_update_vdev

Change-Id: I79c69f6e6f10650cd57fd85dc4d79e8677976247
CRs-Fixed: 2214574
---
 core/wma/src/wma_scan_roam.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/core/wma/src/wma_scan_roam.c b/core/wma/src/wma_scan_roam.c
index f54c067..6f669e8 100644
--- a/core/wma/src/wma_scan_roam.c
+++ b/core/wma/src/wma_scan_roam.c
@@ -2563,7 +2563,6 @@ static void wma_roam_update_vdev(tp_wma_handle wma,
 	qdf_mem_copy(wma->interfaces[vdev_id].bssid,
 			roam_synch_ind_ptr->bssid.bytes, IEEE80211_ADDR_LEN);
 	qdf_mem_free(del_bss_params);
-	qdf_mem_free(del_sta_params);
 	qdf_mem_free(set_link_params);
 	qdf_mem_free(add_sta_params);
 }
-- 
cgit v1.1

