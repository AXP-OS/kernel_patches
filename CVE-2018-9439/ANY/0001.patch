diff --git a/net/packet/af_packet.c b/net/packet/af_packet.c
index 1db48a5..6c7944d 100644
--- a/net/packet/af_packet.c
+++ b/net/packet/af_packet.c
@@ -2660,13 +2660,15 @@
 	int ret = 0;
 	bool unlisted = false;
 
-	if (po->fanout)
-		return -EINVAL;
-
 	lock_sock(sk);
 	spin_lock(&po->bind_lock);
 	rcu_read_lock();
 
+	if (po->fanout) {
+		ret = -EINVAL;
+		goto out_unlock;
+	}
+
 	if (name) {
 		dev = dev_get_by_name_rcu(sock_net(sk), name);
 		if (!dev) {
