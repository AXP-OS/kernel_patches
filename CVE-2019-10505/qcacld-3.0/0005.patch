From 97e31543ad58816d5178be1e9244c47b05893e79 Mon Sep 17 00:00:00 2001
From: Naveen Rawat <naveenrawat@codeaurora.org>
Date: Wed, 23 May 2018 09:57:31 -0700
Subject: qcacld-3.0: Fix incomplete IE handling in dot11 unpack functions

If in dot11f_unpack functions, check for integer underflow fails,
the function returns failure but does not set the present field
of the IE. This present field of the structure is used to check
if IE is present. So even if the unpack failed the IE structure
is considered valid.

Change-Id: I8f572db43a869e48a151ea37dc5b9a2c1fe34eea
CRs-Fixed: 2246426
---
 core/mac/src/include/dot11f.h                  |    2 +-
 core/mac/src/sys/legacy/src/utils/src/dot11f.c | 1624 ++++++++++++++++++------
 2 files changed, 1217 insertions(+), 409 deletions(-)

diff --git a/core/mac/src/include/dot11f.h b/core/mac/src/include/dot11f.h
index bc28b5c..25a34c7 100644
--- a/core/mac/src/include/dot11f.h
+++ b/core/mac/src/include/dot11f.h
@@ -26,7 +26,7 @@
  *
  *
  * This file was automatically generated by 'framesc'
- * Fri Apr 27 15:42:09 2018 from the following file(s):
+ * Wed May 23 09:57:10 2018 from the following file(s):
  *
  * dot11f.frms
  *
diff --git a/core/mac/src/sys/legacy/src/utils/src/dot11f.c b/core/mac/src/sys/legacy/src/utils/src/dot11f.c
index cd5fd65..0b2947b 100644
--- a/core/mac/src/sys/legacy/src/utils/src/dot11f.c
+++ b/core/mac/src/sys/legacy/src/utils/src/dot11f.c
@@ -24,7 +24,7 @@
  *
  *
  * This file was automatically generated by 'framesc'
- * Fri Apr 27 15:42:09 2018 from the following file(s):
+ * Wed May 23 09:57:10 2018 from the following file(s):
  *
  * dot11f.frms
  *
@@ -815,8 +815,10 @@ uint32_t dot11f_unpack_tlv_authorized_ma_cs(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 6))
+	if (unlikely(tlvlen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->mac, pBuf, 6);
 	pBuf += 6;
@@ -839,8 +841,10 @@ uint32_t dot11f_unpack_tlv_version2(tpAniSirGlobal pCtx,
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	uint8_t tmp5__;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp5__ = *pBuf;
 	pBuf += 1;
@@ -899,14 +903,18 @@ uint32_t dot11f_unpack_tlv_extended_listen_timing(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->availibilityPeriod, pBuf, 0);
 	pBuf += 2;
 	tlvlen -= (uint8_t)2;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->availibilityInterval, pBuf, 0);
 	pBuf += 2;
@@ -925,20 +933,26 @@ uint32_t dot11f_unpack_tlv_listen_channel(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 3))
+	if (unlikely(tlvlen < 3)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->countryString, pBuf, 3);
 	pBuf += 3;
 	tlvlen -= (uint8_t)3;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->regulatoryClass = *pBuf;
 	pBuf += 1;
 	tlvlen -= (uint8_t)1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->channel = *pBuf;
 	pBuf += 1;
@@ -1029,14 +1043,18 @@ uint32_t dot11f_unpack_tlv_notice_of_absence(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->index = *pBuf;
 	pBuf += 1;
 	tlvlen -= (uint8_t)1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->CTSWindowOppPS = *pBuf;
 	pBuf += 1;
@@ -1064,20 +1082,26 @@ uint32_t dot11f_unpack_tlv_operating_channel(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 3))
+	if (unlikely(tlvlen < 3)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->countryString, pBuf, 3);
 	pBuf += 3;
 	tlvlen -= (uint8_t)3;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->regulatoryClass = *pBuf;
 	pBuf += 1;
 	tlvlen -= (uint8_t)1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->channel = *pBuf;
 	pBuf += 1;
@@ -1096,14 +1120,18 @@ uint32_t dot11f_unpack_tlv_p2_p_capability(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->deviceCapability = *pBuf;
 	pBuf += 1;
 	tlvlen -= (uint8_t)1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->groupCapability = *pBuf;
 	pBuf += 1;
@@ -1122,8 +1150,10 @@ uint32_t dot11f_unpack_tlv_p2_p_device_id(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 6))
+	if (unlikely(tlvlen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->P2PDeviceAddress, pBuf, 6);
 	pBuf += 6;
@@ -1149,20 +1179,26 @@ uint32_t dot11f_unpack_tlv_p2_p_device_info(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 6))
+	if (unlikely(tlvlen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->P2PDeviceAddress, pBuf, 6);
 	pBuf += 6;
 	tlvlen -= (uint8_t)6;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->configMethod, pBuf, 0);
 	pBuf += 2;
 	tlvlen -= (uint8_t)2;
-	if (unlikely(tlvlen < 8))
+	if (unlikely(tlvlen < 8)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->primaryDeviceType, pBuf, 8);
 	pBuf += 8;
@@ -1209,20 +1245,26 @@ uint32_t dot11f_unpack_tlv_primary_device_type(tpAniSirGlobal pCtx,
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	(void)pBuf; (void)tlvlen; /* Shutup the compiler */
 	pDst->present = 1;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->primary_category, pBuf, 1);
 	pBuf += 2;
 	tlvlen -= (uint8_t)2;
-	if (unlikely(tlvlen < 4))
+	if (unlikely(tlvlen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->oui, pBuf, 4);
 	pBuf += 4;
 	tlvlen -= (uint8_t)4;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->sub_category, pBuf, 1);
 	pBuf += 2;
@@ -1244,20 +1286,26 @@ uint32_t dot11f_unpack_tlv_request_device_type(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->primary_category, pBuf, 1);
 	pBuf += 2;
 	tlvlen -= (uint8_t)2;
-	if (unlikely(tlvlen < 4))
+	if (unlikely(tlvlen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->oui, pBuf, 4);
 	pBuf += 4;
 	tlvlen -= (uint8_t)4;
-	if (unlikely(tlvlen < 2))
+	if (unlikely(tlvlen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->sub_category, pBuf, 1);
 	pBuf += 2;
@@ -1311,8 +1359,10 @@ uint32_t dot11f_unpack_tlv_uuid_e(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 16))
+	if (unlikely(tlvlen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->uuid, pBuf, 16);
 	pBuf += 16;
@@ -1331,8 +1381,10 @@ uint32_t dot11f_unpack_tlv_uuid_r(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 16))
+	if (unlikely(tlvlen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->uuid, pBuf, 16);
 	pBuf += 16;
@@ -1365,8 +1417,10 @@ uint32_t dot11f_unpack_tlv_vendor_extension(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 3))
+	if (unlikely(tlvlen < 3)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->vendorId, pBuf, 3);
 	pBuf += 3;
@@ -1392,8 +1446,10 @@ uint32_t dot11f_unpack_tlv_version(tpAniSirGlobal pCtx,
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	uint8_t tmp6__;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp6__ = *pBuf;
 	pBuf += 1;
@@ -1432,8 +1488,10 @@ uint32_t dot11f_unpack_tlv_non_prefferd_chan_rep(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->oper_class = *pBuf;
 	pBuf += 1;
@@ -1462,8 +1520,10 @@ uint32_t dot11f_unpack_tlv_oce_cap(tpAniSirGlobal pCtx,
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	uint8_t tmp7__;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp7__ = *pBuf;
 	pBuf += 1;
@@ -1487,8 +1547,10 @@ uint32_t dot11f_unpack_tlv_reduced_wan_metrics(tpAniSirGlobal pCtx,
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	uint8_t tmp8__;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp8__ = *pBuf;
 	pBuf += 1;
@@ -1509,14 +1571,18 @@ uint32_t dot11f_unpack_tlv_rssi_assoc_rej(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->delta_rssi = *pBuf;
 	pBuf += 1;
 	tlvlen -= (uint8_t)1;
-	if (unlikely(tlvlen < 1))
+	if (unlikely(tlvlen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->retry_delay = *pBuf;
 	pBuf += 1;
@@ -1541,8 +1607,10 @@ uint32_t dot11f_unpack_tlv_p2_p_interface(tpAniSirGlobal pCtx,
 {
 	uint32_t status = DOT11F_PARSE_SUCCESS;
 	pDst->present = 1;
-	if (unlikely(tlvlen < 6))
+	if (unlikely(tlvlen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->P2PDeviceAddress, pBuf, 6);
 	pBuf += 6;
@@ -1569,22 +1637,28 @@ uint32_t dot11f_unpack_ie_gtk(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp9__, pBuf, 0);
 	pBuf += 2;
 	ielen -= 2;
 	pDst->keyId = tmp9__ >> 0 & 0x3;
 	pDst->reserved = tmp9__ >> 2 & 0x3feb;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->keyLength = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 8))
+	if (unlikely(ielen < 8)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->RSC, pBuf, 8);
 	pBuf += 8;
@@ -1614,26 +1688,34 @@ uint32_t dot11f_unpack_ie_igtk(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->keyID, pBuf, 2);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->IPN, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->keyLength = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 24))
+	if (unlikely(ielen < 24)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->key, pBuf, 24);
 	(void)pCtx;
@@ -1679,8 +1761,10 @@ uint32_t dot11f_unpack_ie_r1_kh_id(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->PMK_R1_ID, pBuf, 6);
 	(void)pCtx;
@@ -1701,8 +1785,10 @@ uint32_t dot11f_unpack_ie_ap_channel_report(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->regulatoryClass = *pBuf;
 	pBuf += 1;
@@ -1732,8 +1818,10 @@ uint32_t dot11f_unpack_ie_bcn_reporting_detail(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->reportingDetail = *pBuf;
 	(void)pCtx;
@@ -1779,14 +1867,18 @@ uint32_t dot11f_unpack_ie_beacon_reporting(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->reportingCondition = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->threshold = *pBuf;
 	(void)pCtx;
@@ -1807,8 +1899,10 @@ uint32_t dot11f_unpack_ie_condensed_country_str(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->countryStr, pBuf, 2);
 	(void)pCtx;
@@ -1829,8 +1923,10 @@ uint32_t dot11f_unpack_ie_measurement_pilot(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->measurementPilot = *pBuf;
 	pBuf += 1;
@@ -1855,8 +1951,10 @@ uint32_t dot11f_unpack_ie_multi_bssid(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->maxBSSIDIndicator = *pBuf;
 	pBuf += 1;
@@ -1881,20 +1979,26 @@ uint32_t dot11f_unpack_ie_ric_data(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->Identifier = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->resourceDescCount = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->statusCode, pBuf, 0);
 	(void)pCtx;
@@ -1915,8 +2019,10 @@ uint32_t dot11f_unpack_ie_ric_descriptor(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->resourceType = *pBuf;
 	pBuf += 1;
@@ -1946,8 +2052,10 @@ uint32_t dot11f_unpack_ie_rrm_enabled_cap(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp10__ = *pBuf;
 	pBuf += 1;
@@ -1960,8 +2068,10 @@ uint32_t dot11f_unpack_ie_rrm_enabled_cap(tpAniSirGlobal pCtx,
 	pDst->BeaconActive = tmp10__ >> 5 & 0x1;
 	pDst->BeaconTable = tmp10__ >> 6 & 0x1;
 	pDst->BeaconRepCond = tmp10__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp11__ = *pBuf;
 	pBuf += 1;
@@ -1974,8 +2084,10 @@ uint32_t dot11f_unpack_ie_rrm_enabled_cap(tpAniSirGlobal pCtx,
 	pDst->LCIAzimuth = tmp11__ >> 5 & 0x1;
 	pDst->TCMCapability = tmp11__ >> 6 & 0x1;
 	pDst->triggeredTCM = tmp11__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp12__ = *pBuf;
 	pBuf += 1;
@@ -1984,8 +2096,10 @@ uint32_t dot11f_unpack_ie_rrm_enabled_cap(tpAniSirGlobal pCtx,
 	pDst->RRMMIBEnabled = tmp12__ >> 1 & 0x1;
 	pDst->operatingChanMax = tmp12__ >> 2 & 0x7;
 	pDst->nonOperatinChanMax = tmp12__ >> 5 & 0x7;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp13__ = *pBuf;
 	pBuf += 1;
@@ -1996,8 +2110,10 @@ uint32_t dot11f_unpack_ie_rrm_enabled_cap(tpAniSirGlobal pCtx,
 	pDst->RCPIMeasurement = tmp13__ >> 5 & 0x1;
 	pDst->RSNIMeasurement = tmp13__ >> 6 & 0x1;
 	pDst->BssAvgAccessDelay = tmp13__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp14__ = *pBuf;
 	pDst->BSSAvailAdmission = tmp14__ >> 0 & 0x1;
@@ -2071,8 +2187,10 @@ uint32_t dot11f_unpack_ie_schedule(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp15__, pBuf, 0);
 	pBuf += 2;
@@ -2081,26 +2199,34 @@ uint32_t dot11f_unpack_ie_schedule(tpAniSirGlobal pCtx,
 	pDst->tsid = tmp15__ >> 1 & 0xf;
 	pDst->direction = tmp15__ >> 5 & 0x3;
 	pDst->reserved = tmp15__ >> 7 & 0x1ff;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_start_time, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_interval, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->max_service_dur, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->spec_interval, pBuf, 0);
 	(void)pCtx;
@@ -2121,124 +2247,162 @@ uint32_t dot11f_unpack_ie_tclas(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->user_priority = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->classifier_type = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->classifier_mask = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
 	switch (pDst->classifier_type) {
 	case 0:
-		if (unlikely(ielen < 6))
+		if (unlikely(ielen < 6)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->info.EthParams.source, pBuf, 6);
 		pBuf += 6;
 		ielen -= (uint8_t)6;
-		if (unlikely(ielen < 6))
+		if (unlikely(ielen < 6)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->info.EthParams.dest, pBuf, 6);
 		pBuf += 6;
 		ielen -= (uint8_t)6;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->info.EthParams.type, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 		break;
 	case 1:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->info.IpParams.version = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
 		switch (pDst->info.IpParams.version) {
 		case 4:
-			if (unlikely(ielen < 4))
+			if (unlikely(ielen < 4)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV4Params.source, pBuf, 4);
 			pBuf += 4;
 			ielen -= (uint8_t)4;
-			if (unlikely(ielen < 4))
+			if (unlikely(ielen < 4)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV4Params.dest, pBuf, 4);
 			pBuf += 4;
 			ielen -= (uint8_t)4;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV4Params.src_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV4Params.dest_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.DSCP = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.proto = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.reserved = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
 			break;
 		case 6:
-			if (unlikely(ielen < 16))
+			if (unlikely(ielen < 16)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.source, pBuf, 16);
 			pBuf += 16;
 			ielen -= (uint8_t)16;
-			if (unlikely(ielen < 16))
+			if (unlikely(ielen < 16)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.dest, pBuf, 16);
 			pBuf += 16;
 			ielen -= (uint8_t)16;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV6Params.src_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV6Params.dest_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 3))
+			if (unlikely(ielen < 3)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.flow_label, pBuf, 3);
 			pBuf += 3;
@@ -2247,8 +2411,10 @@ uint32_t dot11f_unpack_ie_tclas(tpAniSirGlobal pCtx,
 		}
 		break;
 	case 2:
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->info.Params8021dq.tag_type, pBuf, 0);
 		pBuf += 2;
@@ -2276,8 +2442,10 @@ uint32_t dot11f_unpack_ie_ts_delay(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->delay, pBuf, 0);
 	(void)pCtx;
@@ -2298,14 +2466,18 @@ uint32_t dot11f_unpack_ie_tsf_info(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->TsfOffset, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->BeaconIntvl, pBuf, 0);
 	(void)pCtx;
@@ -2329,8 +2501,10 @@ uint32_t dot11f_unpack_ie_tspec(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp16__, pBuf, 0);
 	pBuf += 2;
@@ -2343,102 +2517,134 @@ uint32_t dot11f_unpack_ie_tspec(tpAniSirGlobal pCtx,
 	pDst->psb = tmp16__ >> 10 & 0x1;
 	pDst->user_priority = tmp16__ >> 11 & 0x7;
 	pDst->tsinfo_ack_pol = tmp16__ >> 14 & 0x3;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp17__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->schedule = tmp17__ >> 0 & 0x1;
 	pDst->unused = tmp17__ >> 1 & 0x7f;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp18__, pBuf, 0);
 	pBuf += 2;
 	ielen -= 2;
 	pDst->size = tmp18__ >> 0 & 0x7fff;
 	pDst->fixed = tmp18__ >> 15 & 0x1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->max_msdu_size, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_service_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->max_service_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->inactivity_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->suspension_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_start_time, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->mean_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->peak_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->burst_size, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->delay_bound, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_phy_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->surplus_bw_allowance, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->medium_time, pBuf, 0);
 	(void)pCtx;
@@ -2462,8 +2668,10 @@ uint32_t dot11f_unpack_ie_vht_caps(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &tmp19__, pBuf, 0);
 	pBuf += 4;
@@ -2488,28 +2696,36 @@ uint32_t dot11f_unpack_ie_vht_caps(tpAniSirGlobal pCtx,
 	pDst->rxAntPattern = tmp19__ >> 28 & 0x1;
 	pDst->txAntPattern = tmp19__ >> 29 & 0x1;
 	pDst->reserved1 = tmp19__ >> 30 & 0x3;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->rxMCSMap, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp20__, pBuf, 0);
 	pBuf += 2;
 	ielen -= 2;
 	pDst->rxHighSupDataRate = tmp20__ >> 0 & 0x1fff;
 	pDst->reserved2 = tmp20__ >> 13 & 0x7;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->txMCSMap, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp21__, pBuf, 0);
 	pDst->txSupDataRate = tmp21__ >> 0 & 0x1fff;
@@ -2532,26 +2748,34 @@ uint32_t dot11f_unpack_ie_vht_operation(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->chanWidth = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->chanCenterFreqSeg1 = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->chanCenterFreqSeg2 = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->basicMCSSet, pBuf, 0);
 	(void)pCtx;
@@ -2573,8 +2797,10 @@ uint32_t dot11f_unpack_ie_wmm_schedule(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -2583,8 +2809,10 @@ uint32_t dot11f_unpack_ie_wmm_schedule(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp22__, pBuf, 0);
 	pBuf += 2;
@@ -2593,26 +2821,34 @@ uint32_t dot11f_unpack_ie_wmm_schedule(tpAniSirGlobal pCtx,
 	pDst->tsid = tmp22__ >> 1 & 0xf;
 	pDst->direction = tmp22__ >> 5 & 0x3;
 	pDst->reserved = tmp22__ >> 7 & 0x1ff;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_start_time, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_interval, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->max_service_dur, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->spec_interval, pBuf, 0);
 	(void)pCtx;
@@ -2633,8 +2869,10 @@ uint32_t dot11f_unpack_ie_wmmtclas(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -2643,124 +2881,162 @@ uint32_t dot11f_unpack_ie_wmmtclas(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->user_priority = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->classifier_type = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->classifier_mask = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
 	switch (pDst->classifier_type) {
 	case 0:
-		if (unlikely(ielen < 6))
+		if (unlikely(ielen < 6)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->info.EthParams.source, pBuf, 6);
 		pBuf += 6;
 		ielen -= (uint8_t)6;
-		if (unlikely(ielen < 6))
+		if (unlikely(ielen < 6)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->info.EthParams.dest, pBuf, 6);
 		pBuf += 6;
 		ielen -= (uint8_t)6;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->info.EthParams.type, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 		break;
 	case 1:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->info.IpParams.version = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
 		switch (pDst->info.IpParams.version) {
 		case 4:
-			if (unlikely(ielen < 4))
+			if (unlikely(ielen < 4)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV4Params.source, pBuf, 4);
 			pBuf += 4;
 			ielen -= (uint8_t)4;
-			if (unlikely(ielen < 4))
+			if (unlikely(ielen < 4)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV4Params.dest, pBuf, 4);
 			pBuf += 4;
 			ielen -= (uint8_t)4;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV4Params.src_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV4Params.dest_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.DSCP = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.proto = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->info.IpParams.params.IpV4Params.reserved = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
 			break;
 		case 6:
-			if (unlikely(ielen < 16))
+			if (unlikely(ielen < 16)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.source, pBuf, 16);
 			pBuf += 16;
 			ielen -= (uint8_t)16;
-			if (unlikely(ielen < 16))
+			if (unlikely(ielen < 16)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.dest, pBuf, 16);
 			pBuf += 16;
 			ielen -= (uint8_t)16;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV6Params.src_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->info.IpParams.params.IpV6Params.dest_port, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 3))
+			if (unlikely(ielen < 3)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->info.IpParams.params.IpV6Params.flow_label, pBuf, 3);
 			pBuf += 3;
@@ -2769,8 +3045,10 @@ uint32_t dot11f_unpack_ie_wmmtclas(tpAniSirGlobal pCtx,
 		}
 		break;
 	case 2:
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->info.Params8021dq.tag_type, pBuf, 0);
 		pBuf += 2;
@@ -2795,8 +3073,10 @@ uint32_t dot11f_unpack_ie_wmmtclasproc(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -2805,8 +3085,10 @@ uint32_t dot11f_unpack_ie_wmmtclasproc(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->processing = *pBuf;
 	(void)pCtx;
@@ -2827,8 +3109,10 @@ uint32_t dot11f_unpack_ie_wmmts_delay(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -2837,8 +3121,10 @@ uint32_t dot11f_unpack_ie_wmmts_delay(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->delay, pBuf, 0);
 	(void)pCtx;
@@ -2862,8 +3148,10 @@ uint32_t dot11f_unpack_ie_wmmtspec(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -2872,8 +3160,10 @@ uint32_t dot11f_unpack_ie_wmmtspec(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp23__, pBuf, 0);
 	pBuf += 2;
@@ -2886,102 +3176,134 @@ uint32_t dot11f_unpack_ie_wmmtspec(tpAniSirGlobal pCtx,
 	pDst->psb = tmp23__ >> 10 & 0x1;
 	pDst->user_priority = tmp23__ >> 11 & 0x7;
 	pDst->tsinfo_ack_pol = tmp23__ >> 14 & 0x3;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp24__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->tsinfo_rsvd = tmp24__ >> 0 & 0x7f;
 	pDst->burst_size_defn = tmp24__ >> 7 & 0x1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp25__, pBuf, 0);
 	pBuf += 2;
 	ielen -= 2;
 	pDst->size = tmp25__ >> 0 & 0x7fff;
 	pDst->fixed = tmp25__ >> 15 & 0x1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->max_msdu_size, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_service_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->max_service_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->inactivity_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->suspension_int, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->service_start_time, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->mean_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->peak_data_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->burst_size, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->delay_bound, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->min_phy_rate, pBuf, 0);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->surplus_bw_allowance, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->medium_time, pBuf, 0);
 	(void)pCtx;
@@ -3002,20 +3324,26 @@ uint32_t dot11f_unpack_ie_wider_bw_chan_switch_ann(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->newChanWidth = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->newCenterChanFreq0 = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->newCenterChanFreq1 = *pBuf;
 	(void)pCtx;
@@ -3036,8 +3364,10 @@ uint32_t dot11f_unpack_ie_azimuth_req(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->request = *pBuf;
 	(void)pCtx;
@@ -3058,8 +3388,10 @@ uint32_t dot11f_unpack_ie_max_age(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->max_age, pBuf, 0);
 	(void)pCtx;
@@ -3109,14 +3441,18 @@ uint32_t dot11f_unpack_ie_neighbor_rpt(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->bssid, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp26__ = *pBuf;
 	pBuf += 1;
@@ -3128,8 +3464,10 @@ uint32_t dot11f_unpack_ie_neighbor_rpt(tpAniSirGlobal pCtx,
 	pDst->QosCap = tmp26__ >> 5 & 0x1;
 	pDst->apsd = tmp26__ >> 6 & 0x1;
 	pDst->rrm = tmp26__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp27__ = *pBuf;
 	pBuf += 1;
@@ -3138,26 +3476,34 @@ uint32_t dot11f_unpack_ie_neighbor_rpt(tpAniSirGlobal pCtx,
 	pDst->ImmBA = tmp27__ >> 1 & 0x1;
 	pDst->MobilityDomain = tmp27__ >> 2 & 0x1;
 	pDst->reserved = tmp27__ >> 3 & 0x1f;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->reserved1, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->regulatoryClass = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->channel = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->PhyType = *pBuf;
 	pBuf += 1;
@@ -3188,8 +3534,10 @@ uint32_t dot11f_unpack_ie_req_mac_addr(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->addr, pBuf, 6);
 	(void)pCtx;
@@ -3210,8 +3558,10 @@ uint32_t dot11f_unpack_ie_tgt_mac_addr(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->addr, pBuf, 6);
 	(void)pCtx;
@@ -3257,8 +3607,10 @@ uint32_t dot11f_unpack_ie_aid(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->assocId, pBuf, 0);
 	(void)pCtx;
@@ -3279,26 +3631,34 @@ uint32_t dot11f_unpack_ie_cf_params(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->cfp_count = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->cfp_period = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->cfp_maxduration, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->cfp_durremaining, pBuf, 0);
 	(void)pCtx;
@@ -3344,20 +3704,26 @@ uint32_t dot11f_unpack_ie_chan_switch_ann(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->switchMode = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->newChannel = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->switchCount = *pBuf;
 	(void)pCtx;
@@ -3420,8 +3786,10 @@ uint32_t dot11f_unpack_ie_country(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 3))
+	if (unlikely(ielen < 3)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->country, pBuf, 3);
 	pBuf += 3;
@@ -3467,20 +3835,26 @@ uint32_t dot11f_unpack_ie_edca_param_set(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->qos = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->reserved = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp28__ = *pBuf;
 	pBuf += 1;
@@ -3489,22 +3863,28 @@ uint32_t dot11f_unpack_ie_edca_param_set(tpAniSirGlobal pCtx,
 	pDst->acbe_acm = tmp28__ >> 4 & 0x1;
 	pDst->acbe_aci = tmp28__ >> 5 & 0x3;
 	pDst->unused1 = tmp28__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp29__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acbe_acwmin = tmp29__ >> 0 & 0xf;
 	pDst->acbe_acwmax = tmp29__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acbe_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp30__ = *pBuf;
 	pBuf += 1;
@@ -3513,22 +3893,28 @@ uint32_t dot11f_unpack_ie_edca_param_set(tpAniSirGlobal pCtx,
 	pDst->acbk_acm = tmp30__ >> 4 & 0x1;
 	pDst->acbk_aci = tmp30__ >> 5 & 0x3;
 	pDst->unused2 = tmp30__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp31__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acbk_acwmin = tmp31__ >> 0 & 0xf;
 	pDst->acbk_acwmax = tmp31__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acbk_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp32__ = *pBuf;
 	pBuf += 1;
@@ -3537,22 +3923,28 @@ uint32_t dot11f_unpack_ie_edca_param_set(tpAniSirGlobal pCtx,
 	pDst->acvi_acm = tmp32__ >> 4 & 0x1;
 	pDst->acvi_aci = tmp32__ >> 5 & 0x3;
 	pDst->unused3 = tmp32__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp33__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acvi_acwmin = tmp33__ >> 0 & 0xf;
 	pDst->acvi_acwmax = tmp33__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acvi_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp34__ = *pBuf;
 	pBuf += 1;
@@ -3561,16 +3953,20 @@ uint32_t dot11f_unpack_ie_edca_param_set(tpAniSirGlobal pCtx,
 	pDst->acvo_acm = tmp34__ >> 4 & 0x1;
 	pDst->acvo_aci = tmp34__ >> 5 & 0x3;
 	pDst->unused4 = tmp34__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp35__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acvo_acwmin = tmp35__ >> 0 & 0xf;
 	pDst->acvo_acwmax = tmp35__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acvo_txoplimit, pBuf, 0);
 	(void)pCtx;
@@ -3592,8 +3988,10 @@ uint32_t dot11f_unpack_ie_erp_info(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp36__ = *pBuf;
 	pDst->non_erp_present = tmp36__ >> 0 & 0x1;
@@ -3644,14 +4042,18 @@ uint32_t dot11f_unpack_ie_ese_rad_mgmt_cap(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->mgmt_state = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp37__ = *pBuf;
 	pDst->mbssid_mask = tmp37__ >> 0 & 0x7;
@@ -3674,20 +4076,26 @@ uint32_t dot11f_unpack_ie_ese_traf_strm_met(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->tsid = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->state = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->msmt_interval, pBuf, 0);
 	(void)pCtx;
@@ -3708,8 +4116,10 @@ uint32_t dot11f_unpack_ie_ese_traf_strm_rate_set(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->tsid = *pBuf;
 	pBuf += 1;
@@ -3739,14 +4149,18 @@ uint32_t dot11f_unpack_ie_ese_txmit_power(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->power_limit = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->reserved = *pBuf;
 	(void)pCtx;
@@ -3767,8 +4181,10 @@ uint32_t dot11f_unpack_ie_ese_version(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	(void)pCtx;
@@ -3877,26 +4293,34 @@ uint32_t dot11f_unpack_ie_fh_param_set(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->dwell_time, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->hop_set = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->hop_pattern = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->hop_index = *pBuf;
 	(void)pCtx;
@@ -3917,14 +4341,18 @@ uint32_t dot11f_unpack_ie_fh_params(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->radix = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->nchannels = *pBuf;
 	(void)pCtx;
@@ -3945,26 +4373,34 @@ uint32_t dot11f_unpack_ie_fh_patt_table(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->flag = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->nsets = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->modulus = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->offset = *pBuf;
 	pBuf += 1;
@@ -4014,28 +4450,36 @@ uint32_t dot11f_unpack_ie_ft_info(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp38__, pBuf, 0);
 	pBuf += 2;
 	ielen -= 2;
 	pDst->reserved = tmp38__ >> 0 & 0xff;
 	pDst->IECount = tmp38__ >> 8 & 0xff;
-	if (unlikely(ielen < 16))
+	if (unlikely(ielen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->MIC, pBuf, 16);
 	pBuf += 16;
 	ielen -= (uint8_t)16;
-	if (unlikely(ielen < 32))
+	if (unlikely(ielen < 32)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->Anonce, pBuf, 32);
 	pBuf += 32;
 	ielen -= (uint8_t)32;
-	if (unlikely(ielen < 32))
+	if (unlikely(ielen < 32)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->Snonce, pBuf, 32);
 	pBuf += 32;
@@ -4071,8 +4515,10 @@ uint32_t dot11f_unpack_ie_ht_caps(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp39__, pBuf, 0);
 	pBuf += 2;
@@ -4091,8 +4537,10 @@ uint32_t dot11f_unpack_ie_ht_caps(tpAniSirGlobal pCtx,
 	pDst->psmp = tmp39__ >> 13 & 0x1;
 	pDst->stbcControlFrame = tmp39__ >> 14 & 0x1;
 	pDst->lsigTXOPProtection = tmp39__ >> 15 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp40__ = *pBuf;
 	pBuf += 1;
@@ -4100,14 +4548,18 @@ uint32_t dot11f_unpack_ie_ht_caps(tpAniSirGlobal pCtx,
 	pDst->maxRxAMPDUFactor = tmp40__ >> 0 & 0x3;
 	pDst->mpduDensity = tmp40__ >> 2 & 0x7;
 	pDst->reserved1 = tmp40__ >> 5 & 0x7;
-	if (unlikely(ielen < 16))
+	if (unlikely(ielen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->supportedMCSSet, pBuf, 16);
 	pBuf += 16;
 	ielen -= (uint8_t)16;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp41__, pBuf, 0);
 	pBuf += 2;
@@ -4117,8 +4569,10 @@ uint32_t dot11f_unpack_ie_ht_caps(tpAniSirGlobal pCtx,
 	pDst->reserved2 = tmp41__ >> 3 & 0x1f;
 	pDst->mcsFeedback = tmp41__ >> 8 & 0x3;
 	pDst->reserved3 = tmp41__ >> 10 & 0x3f;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &tmp42__, pBuf, 0);
 	pBuf += 4;
@@ -4139,8 +4593,10 @@ uint32_t dot11f_unpack_ie_ht_caps(tpAniSirGlobal pCtx,
 	pDst->uncompressedSteeringMatrixBFAntennae = tmp42__ >> 21 & 0x3;
 	pDst->compressedSteeringMatrixBFAntennae = tmp42__ >> 23 & 0x3;
 	pDst->reserved4 = tmp42__ >> 25 & 0x7f;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp43__ = *pBuf;
 	pBuf += 1;
@@ -4181,14 +4637,18 @@ uint32_t dot11f_unpack_ie_ht_info(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->primaryChannel = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp44__ = *pBuf;
 	pBuf += 1;
@@ -4198,8 +4658,10 @@ uint32_t dot11f_unpack_ie_ht_info(tpAniSirGlobal pCtx,
 	pDst->rifsMode = tmp44__ >> 3 & 0x1;
 	pDst->controlledAccessOnly = tmp44__ >> 4 & 0x1;
 	pDst->serviceIntervalGranularity = tmp44__ >> 5 & 0x7;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp45__, pBuf, 0);
 	pBuf += 2;
@@ -4209,8 +4671,10 @@ uint32_t dot11f_unpack_ie_ht_info(tpAniSirGlobal pCtx,
 	pDst->transmitBurstLimit = tmp45__ >> 3 & 0x1;
 	pDst->obssNonHTStaPresent = tmp45__ >> 4 & 0x1;
 	pDst->reserved = tmp45__ >> 5 & 0x7ff;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp46__, pBuf, 0);
 	pBuf += 2;
@@ -4222,8 +4686,10 @@ uint32_t dot11f_unpack_ie_ht_info(tpAniSirGlobal pCtx,
 	pDst->pcoActive = tmp46__ >> 10 & 0x1;
 	pDst->pcoPhase = tmp46__ >> 11 & 0x1;
 	pDst->reserved2 = tmp46__ >> 12 & 0xf;
-	if (unlikely(ielen < 16))
+	if (unlikely(ielen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->basicMCSSet, pBuf, 16);
 	pBuf += 16;
@@ -4253,8 +4719,10 @@ uint32_t dot11f_unpack_ie_ibss_params(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->atim, pBuf, 0);
 	(void)pCtx;
@@ -4275,20 +4743,26 @@ uint32_t dot11f_unpack_ie_link_identifier(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->bssid, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->InitStaAddr, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->RespStaAddr, pBuf, 6);
 	(void)pCtx;
@@ -4388,14 +4862,18 @@ uint32_t dot11f_unpack_ie_measurement_report(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->token = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp47__ = *pBuf;
 	pBuf += 1;
@@ -4404,8 +4882,10 @@ uint32_t dot11f_unpack_ie_measurement_report(tpAniSirGlobal pCtx,
 	pDst->incapable = tmp47__ >> 1 & 0x1;
 	pDst->refused = tmp47__ >> 2 & 0x1;
 	pDst->unused = tmp47__ >> 3 & 0x1f;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->type = *pBuf;
 	pBuf += 1;
@@ -4415,26 +4895,34 @@ uint32_t dot11f_unpack_ie_measurement_report(tpAniSirGlobal pCtx,
 	} else {
 		switch (pDst->type) {
 		case 0:
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Basic.channel = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 8))
+			if (unlikely(ielen < 8)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohq(pCtx, &pDst->report.Basic.meas_start_time, pBuf, 0);
 			pBuf += 8;
 			ielen -= (uint8_t)8;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->report.Basic.meas_duration, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			tmp48__ = *pBuf;
 			pBuf += 1;
@@ -4447,158 +4935,208 @@ uint32_t dot11f_unpack_ie_measurement_report(tpAniSirGlobal pCtx,
 			pDst->report.Basic.unused = tmp48__ >> 5 & 0x7;
 			break;
 		case 1:
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.CCA.channel = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 8))
+			if (unlikely(ielen < 8)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohq(pCtx, &pDst->report.CCA.meas_start_time, pBuf, 0);
 			pBuf += 8;
 			ielen -= (uint8_t)8;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->report.CCA.meas_duration, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.CCA.cca_busy_fraction = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
 			break;
 		case 2:
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.channel = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 8))
+			if (unlikely(ielen < 8)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohq(pCtx, &pDst->report.RPIHistogram.meas_start_time, pBuf, 0);
 			pBuf += 8;
 			ielen -= (uint8_t)8;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->report.RPIHistogram.meas_duration, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi0_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi1_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi2_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi3_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi4_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi5_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi6_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.RPIHistogram.rpi7_density = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
 			break;
 		case 5:
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Beacon.regClass = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Beacon.channel = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 8))
+			if (unlikely(ielen < 8)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohq(pCtx, &pDst->report.Beacon.meas_start_time, pBuf, 0);
 			pBuf += 8;
 			ielen -= (uint8_t)8;
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->report.Beacon.meas_duration, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			tmp49__ = *pBuf;
 			pBuf += 1;
 			ielen -= 1;
 			pDst->report.Beacon.condensed_PHY = tmp49__ >> 0 & 0x7f;
 			pDst->report.Beacon.reported_frame_type = tmp49__ >> 7 & 0x1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Beacon.RCPI = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Beacon.RSNI = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 6))
+			if (unlikely(ielen < 6)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			DOT11F_MEMCPY(pCtx, pDst->report.Beacon.BSSID, pBuf, 6);
 			pBuf += 6;
 			ielen -= (uint8_t)6;
-			if (unlikely(ielen < 1))
+			if (unlikely(ielen < 1)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			pDst->report.Beacon.antenna_id = *pBuf;
 			pBuf += 1;
 			ielen -= (uint8_t)1;
-			if (unlikely(ielen < 4))
+			if (unlikely(ielen < 4)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohl(pCtx, &pDst->report.Beacon.parent_TSF, pBuf, 0);
 			pBuf += 4;
@@ -4702,14 +5240,18 @@ uint32_t dot11f_unpack_ie_measurement_request(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->measurement_token = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp50__ = *pBuf;
 	pBuf += 1;
@@ -4720,106 +5262,138 @@ uint32_t dot11f_unpack_ie_measurement_request(tpAniSirGlobal pCtx,
 	pDst->report = tmp50__ >> 3 & 0x1;
 	pDst->durationMandatory = tmp50__ >> 4 & 0x1;
 	pDst->unused = tmp50__ >> 5 & 0x7;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->measurement_type = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
 	switch (pDst->measurement_type) {
 	case 0:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.Basic.channel_no = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 8))
+		if (unlikely(ielen < 8)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->measurement_request.Basic.meas_start_time, pBuf, 8);
 		pBuf += 8;
 		ielen -= (uint8_t)8;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.Basic.meas_duration, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 		break;
 	case 1:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.CCA.channel_no = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 8))
+		if (unlikely(ielen < 8)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->measurement_request.CCA.meas_start_time, pBuf, 8);
 		pBuf += 8;
 		ielen -= (uint8_t)8;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.CCA.meas_duration, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 		break;
 	case 2:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.RPIHistogram.channel_no = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 8))
+		if (unlikely(ielen < 8)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->measurement_request.RPIHistogram.meas_start_time, pBuf, 8);
 		pBuf += 8;
 		ielen -= (uint8_t)8;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.RPIHistogram.meas_duration, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 		break;
 	case 5:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.Beacon.regClass = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.Beacon.channel = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.Beacon.randomization, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.Beacon.meas_duration, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.Beacon.meas_mode = *pBuf;
 		pBuf += 1;
 		ielen -= (uint8_t)1;
-		if (unlikely(ielen < 6))
+		if (unlikely(ielen < 6)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->measurement_request.Beacon.BSSID, pBuf, 6);
 		pBuf += 6;
@@ -4833,8 +5407,10 @@ uint32_t dot11f_unpack_ie_measurement_request(tpAniSirGlobal pCtx,
 				sizeof(*pDst), append_ie);
 		break;
 	case 8:
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.lci.loc_subject = *pBuf;
 		pBuf += 1;
@@ -4848,14 +5424,18 @@ uint32_t dot11f_unpack_ie_measurement_request(tpAniSirGlobal pCtx,
 				sizeof(*pDst), append_ie);
 		break;
 	case 16:
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->measurement_request.ftmrr.random_interval, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
-		if (unlikely(ielen < 1))
+		if (unlikely(ielen < 1)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		pDst->measurement_request.ftmrr.min_ap_count = *pBuf;
 		pBuf += 1;
@@ -4888,14 +5468,18 @@ uint32_t dot11f_unpack_ie_mobility_domain(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->MDID, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp51__ = *pBuf;
 	pDst->overDSCap = tmp51__ >> 0 & 0x1;
@@ -4948,14 +5532,18 @@ uint32_t dot11f_unpack_ie_neighbor_report(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->bssid, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp52__ = *pBuf;
 	pBuf += 1;
@@ -4967,8 +5555,10 @@ uint32_t dot11f_unpack_ie_neighbor_report(tpAniSirGlobal pCtx,
 	pDst->QosCap = tmp52__ >> 5 & 0x1;
 	pDst->apsd = tmp52__ >> 6 & 0x1;
 	pDst->rrm = tmp52__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp53__ = *pBuf;
 	pBuf += 1;
@@ -4977,26 +5567,34 @@ uint32_t dot11f_unpack_ie_neighbor_report(tpAniSirGlobal pCtx,
 	pDst->ImmBA = tmp53__ >> 1 & 0x1;
 	pDst->MobilityDomain = tmp53__ >> 2 & 0x1;
 	pDst->reserved = tmp53__ >> 3 & 0x1f;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->reserved1, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->regulatoryClass = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->channel = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->PhyType = *pBuf;
 	pBuf += 1;
@@ -5027,44 +5625,58 @@ uint32_t dot11f_unpack_ie_obss_scan_parameters(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->obssScanPassiveDwell, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->obssScanActiveDwell, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->bssChannelWidthTriggerScanInterval, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->obssScanPassiveTotalPerChannel, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->obssScanActiveTotalPerChannel, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->bssWidthChannelTransitionDelayFactor, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->obssScanActivityThreshold, pBuf, 0);
 	(void)pCtx;
@@ -5086,8 +5698,10 @@ uint32_t dot11f_unpack_ie_operating_mode(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp54__ = *pBuf;
 	pDst->chanWidth = tmp54__ >> 0 & 0x3;
@@ -5402,14 +6016,18 @@ uint32_t dot11f_unpack_ie_pti_control(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->tid = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->sequence_control, pBuf, 0);
 	(void)pCtx;
@@ -5431,8 +6049,10 @@ uint32_t dot11f_unpack_ie_pu_buffer_status(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp55__ = *pBuf;
 	pDst->ac_bk_traffic_aval = tmp55__ >> 0 & 0x1;
@@ -5458,14 +6078,18 @@ uint32_t dot11f_unpack_ie_power_caps(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->minTxPower = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->maxTxPower = *pBuf;
 	(void)pCtx;
@@ -5486,8 +6110,10 @@ uint32_t dot11f_unpack_ie_power_constraints(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->localPowerConstraints = *pBuf;
 	(void)pCtx;
@@ -5508,20 +6134,26 @@ uint32_t dot11f_unpack_ie_qbss_load(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->stacount, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->chautil = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->avail, pBuf, 0);
 	(void)pCtx;
@@ -5542,8 +6174,10 @@ uint32_t dot11f_unpack_ie_QCN_IE(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->version, pBuf, 4);
 	(void)pCtx;
@@ -5564,14 +6198,18 @@ uint32_t dot11f_unpack_ie_QComVendorIE(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->type = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->channel = *pBuf;
 	(void)pCtx;
@@ -5593,8 +6231,10 @@ uint32_t dot11f_unpack_ie_qos_caps_ap(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp56__ = *pBuf;
 	pDst->count = tmp56__ >> 0 & 0xf;
@@ -5621,8 +6261,10 @@ uint32_t dot11f_unpack_ie_qos_caps_station(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp57__ = *pBuf;
 	pDst->acvo_uapsd = tmp57__ >> 0 & 0x1;
@@ -5675,26 +6317,34 @@ uint32_t dot11f_unpack_ie_quiet(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->count = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->period = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->duration, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->offset, pBuf, 0);
 	(void)pCtx;
@@ -5715,8 +6365,10 @@ uint32_t dot11f_unpack_ie_rcpiie(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->rcpi = *pBuf;
 	(void)pCtx;
@@ -5813,8 +6465,10 @@ uint32_t dot11f_unpack_ie_rsn(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->version, pBuf, 0);
 	pBuf += 2;
@@ -5837,8 +6491,6 @@ uint32_t dot11f_unpack_ie_rsn(tpAniSirGlobal pCtx,
 		ielen -= (uint8_t)2;
 	}
 	if (pDst->pwise_cipher_suite_count > 6) {
-	if (unlikely(ielen < pDst->pwise_cipher_suite_count * 4))
-		return DOT11F_INCOMPLETE_IE;
 		pDst->present = 0;
 		return DOT11F_SKIPPED_BAD_IE;
 	}
@@ -5867,8 +6519,10 @@ uint32_t dot11f_unpack_ie_rsn(tpAniSirGlobal pCtx,
 		pDst->pmkid_count = 0U;
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->RSN_Cap, pBuf, 2);
 		pBuf += 2;
@@ -5878,15 +6532,19 @@ uint32_t dot11f_unpack_ie_rsn(tpAniSirGlobal pCtx,
 		pDst->pmkid_count = 0U;
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->pmkid_count, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 	}
-	if (unlikely(ielen < pDst->pmkid_count * 16))
+	if (unlikely(ielen < pDst->pmkid_count * 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->pmkid_count > 4) {
 		pDst->present = 0;
@@ -5899,8 +6557,10 @@ uint32_t dot11f_unpack_ie_rsn(tpAniSirGlobal pCtx,
 	if (!ielen) {
 		return 0U;
 	} else {
-		if (unlikely(ielen < 4))
+		if (unlikely(ielen < 4)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->gp_mgmt_cipher_suite, pBuf, 4);
 	}
@@ -5922,8 +6582,10 @@ uint32_t dot11f_unpack_ie_rsniie(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->rsni = *pBuf;
 	(void)pCtx;
@@ -6052,20 +6714,26 @@ uint32_t dot11f_unpack_ie_tim(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->dtim_count = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->dtim_period = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->bmpctl = *pBuf;
 	pBuf += 1;
@@ -6095,14 +6763,18 @@ uint32_t dot11f_unpack_ie_tpc_report(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->tx_power = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->link_margin = *pBuf;
 	(void)pCtx;
@@ -6141,20 +6813,26 @@ uint32_t dot11f_unpack_ie_time_advertisement(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->timing_capabilities = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 10))
+	if (unlikely(ielen < 10)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->time_value, pBuf, 10);
 	pBuf += 10;
 	ielen -= (uint8_t)10;
-	if (unlikely(ielen < 5))
+	if (unlikely(ielen < 5)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->time_error, pBuf, 5);
 	(void)pCtx;
@@ -6175,14 +6853,18 @@ uint32_t dot11f_unpack_ie_timeout_interval(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->timeoutType = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohl(pCtx, &pDst->timeoutValue, pBuf, 0);
 	(void)pCtx;
@@ -6203,32 +6885,42 @@ uint32_t dot11f_unpack_ie_vht_ext_bss_load(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->muMIMOCapStaCount = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->ssUnderUtil = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->FortyMHzUtil = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->EightyMHzUtil = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->OneSixtyMHzUtil = *pBuf;
 	(void)pCtx;
@@ -6286,8 +6978,10 @@ uint32_t dot11f_unpack_ie_wapi(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->version, pBuf, 0);
 	pBuf += 2;
@@ -6296,14 +6990,18 @@ uint32_t dot11f_unpack_ie_wapi(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->akm_suite_count, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < pDst->akm_suite_count * 4))
+	if (unlikely(ielen < pDst->akm_suite_count * 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->akm_suite_count > 4) {
 		pDst->present = 0;
@@ -6313,14 +7011,18 @@ uint32_t dot11f_unpack_ie_wapi(tpAniSirGlobal pCtx,
 	DOT11F_MEMCPY(pCtx, pDst->akm_suites, pBuf, (pDst->akm_suite_count * 4));
 	pBuf += (pDst->akm_suite_count * 4);
 	ielen -= (pDst->akm_suite_count * 4);
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->unicast_cipher_suite_count, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < pDst->unicast_cipher_suite_count * 4))
+	if (unlikely(ielen < pDst->unicast_cipher_suite_count * 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->unicast_cipher_suite_count > 4) {
 		pDst->present = 0;
@@ -6330,14 +7032,18 @@ uint32_t dot11f_unpack_ie_wapi(tpAniSirGlobal pCtx,
 	DOT11F_MEMCPY(pCtx, pDst->unicast_cipher_suites, pBuf, (pDst->unicast_cipher_suite_count * 4));
 	pBuf += (pDst->unicast_cipher_suite_count * 4);
 	ielen -= (pDst->unicast_cipher_suite_count * 4);
-	if (unlikely(ielen < 4))
+	if (unlikely(ielen < 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->multicast_cipher_suite, pBuf, 4);
 	pBuf += 4;
 	ielen -= (uint8_t)4;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp58__, pBuf, 0);
 	pBuf += 2;
@@ -6348,15 +7054,19 @@ uint32_t dot11f_unpack_ie_wapi(tpAniSirGlobal pCtx,
 		pDst->bkid_count = 0U;
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->bkid_count, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 	}
-	if (unlikely(ielen < pDst->bkid_count * 16))
+	if (unlikely(ielen < pDst->bkid_count * 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->bkid_count > 4) {
 		pDst->present = 0;
@@ -6407,14 +7117,18 @@ uint32_t dot11f_unpack_ie_wfatpc(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->txPower = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->linkMargin = *pBuf;
 	(void)pCtx;
@@ -6461,8 +7175,10 @@ uint32_t dot11f_unpack_ie_wmm_caps(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -6471,8 +7187,10 @@ uint32_t dot11f_unpack_ie_wmm_caps(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp59__ = *pBuf;
 	pDst->reserved = tmp59__ >> 0 & 0xf;
@@ -6499,14 +7217,18 @@ uint32_t dot11f_unpack_ie_wmm_info_ap(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp60__ = *pBuf;
 	pDst->param_set_count = tmp60__ >> 0 & 0xf;
@@ -6531,14 +7253,18 @@ uint32_t dot11f_unpack_ie_wmm_info_station(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp61__ = *pBuf;
 	pDst->acvo_uapsd = tmp61__ >> 0 & 0x1;
@@ -6574,8 +7300,10 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->version = *pBuf;
 	pBuf += 1;
@@ -6584,20 +7312,26 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 		pDst->present = 0;
 		return status | DOT11F_BAD_FIXED_VALUE;
 	}
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->qosInfo = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->reserved2 = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp62__ = *pBuf;
 	pBuf += 1;
@@ -6606,22 +7340,28 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 	pDst->acbe_acm = tmp62__ >> 4 & 0x1;
 	pDst->acbe_aci = tmp62__ >> 5 & 0x3;
 	pDst->unused1 = tmp62__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp63__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acbe_acwmin = tmp63__ >> 0 & 0xf;
 	pDst->acbe_acwmax = tmp63__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acbe_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp64__ = *pBuf;
 	pBuf += 1;
@@ -6630,22 +7370,28 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 	pDst->acbk_acm = tmp64__ >> 4 & 0x1;
 	pDst->acbk_aci = tmp64__ >> 5 & 0x3;
 	pDst->unused2 = tmp64__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp65__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acbk_acwmin = tmp65__ >> 0 & 0xf;
 	pDst->acbk_acwmax = tmp65__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acbk_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp66__ = *pBuf;
 	pBuf += 1;
@@ -6654,22 +7400,28 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 	pDst->acvi_acm = tmp66__ >> 4 & 0x1;
 	pDst->acvi_aci = tmp66__ >> 5 & 0x3;
 	pDst->unused3 = tmp66__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp67__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acvi_acwmin = tmp67__ >> 0 & 0xf;
 	pDst->acvi_acwmax = tmp67__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acvi_txoplimit, pBuf, 0);
 	pBuf += 2;
 	ielen -= (uint8_t)2;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp68__ = *pBuf;
 	pBuf += 1;
@@ -6678,16 +7430,20 @@ uint32_t dot11f_unpack_ie_wmm_params(tpAniSirGlobal pCtx,
 	pDst->acvo_acm = tmp68__ >> 4 & 0x1;
 	pDst->acvo_aci = tmp68__ >> 5 & 0x3;
 	pDst->unused4 = tmp68__ >> 7 & 0x1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp69__ = *pBuf;
 	pBuf += 1;
 	ielen -= 1;
 	pDst->acvo_acwmin = tmp69__ >> 0 & 0xf;
 	pDst->acvo_acwmax = tmp69__ >> 4 & 0xf;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->acvo_txoplimit, pBuf, 0);
 	(void)pCtx;
@@ -6708,8 +7464,10 @@ uint32_t dot11f_unpack_ie_wpa(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &pDst->version, pBuf, 0);
 	pBuf += 2;
@@ -6725,8 +7483,10 @@ uint32_t dot11f_unpack_ie_wpa(tpAniSirGlobal pCtx,
 		return 0U;
 	} else {
 		pDst->multicast_cipher_present = 1U;
-		if (unlikely(ielen < 4))
+		if (unlikely(ielen < 4)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		DOT11F_MEMCPY(pCtx, pDst->multicast_cipher, pBuf, 4);
 		pBuf += 4;
@@ -6737,15 +7497,19 @@ uint32_t dot11f_unpack_ie_wpa(tpAniSirGlobal pCtx,
 		pDst->auth_suite_count = 0U;
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->unicast_cipher_count, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 	}
-	if (unlikely(ielen < pDst->unicast_cipher_count * 4))
+	if (unlikely(ielen < pDst->unicast_cipher_count * 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->unicast_cipher_count > 4) {
 		pDst->present = 0;
@@ -6759,15 +7523,19 @@ uint32_t dot11f_unpack_ie_wpa(tpAniSirGlobal pCtx,
 		pDst->auth_suite_count = 0U;
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->auth_suite_count, pBuf, 0);
 		pBuf += 2;
 		ielen -= (uint8_t)2;
 	}
-	if (unlikely(ielen < pDst->auth_suite_count * 4))
+	if (unlikely(ielen < pDst->auth_suite_count * 4)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	if (pDst->auth_suite_count > 4) {
 		pDst->present = 0;
@@ -6780,8 +7548,10 @@ uint32_t dot11f_unpack_ie_wpa(tpAniSirGlobal pCtx,
 	if (!ielen) {
 		return 0U;
 	} else {
-		if (unlikely(ielen < 2))
+		if (unlikely(ielen < 2)) {
+			pDst->present = 0;
 			return DOT11F_INCOMPLETE_IE;
+		}
 
 		framesntohs(pCtx, &pDst->caps, pBuf, 0);
 	}
@@ -7322,26 +8092,34 @@ uint32_t dot11f_unpack_ie_ext_chan_switch_ann(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->switch_mode = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->new_reg_class = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->new_channel = *pBuf;
 	pBuf += 1;
 	ielen -= (uint8_t)1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->switch_count = *pBuf;
 	(void)pCtx;
@@ -7362,8 +8140,10 @@ uint32_t dot11f_unpack_ie_fils_assoc_delay_info(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->assoc_delay_info = *pBuf;
 	(void)pCtx;
@@ -7384,14 +8164,18 @@ uint32_t dot11f_unpack_ie_fils_hlp_container(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->dest_mac, pBuf, 6);
 	pBuf += 6;
 	ielen -= (uint8_t)6;
-	if (unlikely(ielen < 6))
+	if (unlikely(ielen < 6)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->src_mac, pBuf, 6);
 	pBuf += 6;
@@ -7417,8 +8201,10 @@ uint32_t dot11f_unpack_ie_fils_indication(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 2))
+	if (unlikely(ielen < 2)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	framesntohs(pCtx, &tmp70__, pBuf, 0);
 	pBuf += 2;
@@ -7452,8 +8238,10 @@ uint32_t dot11f_unpack_ie_fils_kde(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 8))
+	if (unlikely(ielen < 8)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->key_rsc, pBuf, 8);
 	pBuf += 8;
@@ -7498,8 +8286,10 @@ uint32_t dot11f_unpack_ie_fils_nonce(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 16))
+	if (unlikely(ielen < 16)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->nonce, pBuf, 16);
 	(void)pCtx;
@@ -7520,8 +8310,10 @@ uint32_t dot11f_unpack_ie_fils_public_key(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->key_type = *pBuf;
 	pBuf += 1;
@@ -7546,8 +8338,10 @@ uint32_t dot11f_unpack_ie_fils_session(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 8))
+	if (unlikely(ielen < 8)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	DOT11F_MEMCPY(pCtx, pDst->session, pBuf, 8);
 	(void)pCtx;
@@ -7609,8 +8403,10 @@ uint32_t dot11f_unpack_ie_hs20vendor_ie(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp71__ = *pBuf;
 	pBuf += 1;
@@ -7624,16 +8420,20 @@ uint32_t dot11f_unpack_ie_hs20vendor_ie(tpAniSirGlobal pCtx,
 	} else {
 		switch (pDst->hs_id_present) {
 		case 1:
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->hs_id.pps_mo.pps_mo_id, pBuf, 0);
 			pBuf += 2;
 			ielen -= (uint8_t)2;
 			break;
 		case 2:
-			if (unlikely(ielen < 2))
+			if (unlikely(ielen < 2)) {
+				pDst->present = 0;
 				return DOT11F_INCOMPLETE_IE;
+			}
 
 			framesntohs(pCtx, &pDst->hs_id.anqp_domain.anqp_domain_id, pBuf, 0);
 			pBuf += 2;
@@ -7660,8 +8460,10 @@ uint32_t dot11f_unpack_ie_ht2040_bss_coexistence(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	tmp72__ = *pBuf;
 	pDst->info_request = tmp72__ >> 0 & 0x1;
@@ -7688,8 +8490,10 @@ uint32_t dot11f_unpack_ie_ht2040_bss_intolerant_report(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->operating_class = *pBuf;
 	pBuf += 1;
@@ -7739,8 +8543,10 @@ uint32_t dot11f_unpack_ie_sec_chan_offset_ele(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->secondaryChannelOffset = *pBuf;
 	(void)pCtx;
@@ -7776,8 +8582,10 @@ uint32_t dot11f_unpack_ie_vendor_vht_ie(tpAniSirGlobal pCtx,
 	if (pDst->present)
 		status = DOT11F_DUPLICATE_IE;
 	pDst->present = 1;
-	if (unlikely(ielen < 1))
+	if (unlikely(ielen < 1)) {
+		pDst->present = 0;
 		return DOT11F_INCOMPLETE_IE;
+	}
 
 	pDst->sub_type = *pBuf;
 	pBuf += 1;
-- 
cgit v1.1

