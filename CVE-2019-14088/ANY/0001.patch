From 3e23cdbb1b2a38881f11f3c15ce82f583be0e235 Mon Sep 17 00:00:00 2001
From: Karthik Anantha Ram <kartanan@codeaurora.org>
Date: Thu, 29 Nov 2018 17:47:42 -0800
Subject: msm: camera: reqmgr: Remove kfree calls on link struct

Links are statically allocated removing the kfree calls for
this struct.

Change-Id: Id912525e3617502233a25053c75ef92bfa03144f
Signed-off-by: Karthik Anantha Ram <kartanan@codeaurora.org>
Signed-off-by: Alok Chauhan <alokc@codeaurora.org>
---
 drivers/media/platform/msm/camera/cam_req_mgr/cam_req_mgr_core.c | 3 ---
 1 file changed, 3 deletions(-)

diff --git a/drivers/media/platform/msm/camera/cam_req_mgr/cam_req_mgr_core.c b/drivers/media/platform/msm/camera/cam_req_mgr/cam_req_mgr_core.c
index b5601b1..98d0eaf 100644
--- a/drivers/media/platform/msm/camera/cam_req_mgr/cam_req_mgr_core.c
+++ b/drivers/media/platform/msm/camera/cam_req_mgr/cam_req_mgr_core.c
@@ -1371,12 +1371,10 @@ static struct cam_req_mgr_core_link *__cam_req_mgr_reserve_link(
 		kzalloc(sizeof(struct cam_req_mgr_req_queue), GFP_KERNEL);
 	if (!in_q) {
 		CAM_ERR(CAM_CRM, "failed to create input queue, no mem");
-		kfree(link);
 		return NULL;
 	}
 
 	mutex_lock(&link->lock);
-	link->state = CAM_CRM_LINK_STATE_AVAILABLE;
 	link->num_devs = 0;
 	link->max_delay = 0;
 	memset(in_q->slot, 0,
@@ -1413,7 +1411,6 @@ static struct cam_req_mgr_core_link *__cam_req_mgr_reserve_link(
 	return link;
 error:
 	mutex_unlock(&session->lock);
-	kfree(link);
 	kfree(in_q);
 	return NULL;
 }
-- 
cgit v1.1

