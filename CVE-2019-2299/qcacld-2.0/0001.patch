From 369284f71db1065cae647c0bbe4133e23b9cef4a Mon Sep 17 00:00:00 2001
From: hqu <hqu@codeaurora.org>
Date: Thu, 22 Nov 2018 16:20:33 +0800
Subject: qcacld-2.0: Fix possible buffer overflow in wma_stats_ext_req

In the function __wlan_hdd_cfg80211_stats_ext_request, data_len
is recieved from vendor command and is passed ultimately to
wma_stats_ext_req. In wma_stats_ext_req, len is calculated as
sum of sizeof(*cmd), WMI_TLV_HDR_SIZE, preq->request_data_len.
The len is of type u_int16_t and adding
sizeof(*cmd) + WMI_TLV_HDR_SIZE will cause a buffer overflow.

Changed the datatype of len to size_t so that it doesn't overflow.

Change-Id: I6618042e3c60bbdb1ff5d833188f4bdb4832da7a
CRs-Fixed: 2350908
---
 CORE/SERVICES/WMA/wma.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CORE/SERVICES/WMA/wma.c b/CORE/SERVICES/WMA/wma.c
index f761f76..428cc32 100644
--- a/CORE/SERVICES/WMA/wma.c
+++ b/CORE/SERVICES/WMA/wma.c
@@ -30413,7 +30413,7 @@ VOS_STATUS wma_stats_ext_req(void *wda_handle,
 	tp_wma_handle wma = (tp_wma_handle)wda_handle;
 	wmi_req_stats_ext_cmd_fixed_param *cmd;
 	wmi_buf_t buf;
-	u_int16_t len;
+	size_t len;
 	u_int8_t *buf_ptr;
 
 	len = sizeof(*cmd) + WMI_TLV_HDR_SIZE +
-- 
cgit v1.1

