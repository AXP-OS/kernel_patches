From mboxrd@z Thu Jan  1 00:00:00 1970
Return-Path: <stable-owner@vger.kernel.org>
X-Cyrus-Session-Id: sloti22d1t05-1509659-1525306029-2-6312676819182240102
X-Sieve: CMU Sieve 3.0
X-Spam-known-sender: no
X-Spam-score: 0.0
X-Spam-hits: BAYES_00 -1.9, HEADER_FROM_DIFFERENT_DOMAINS 0.25, MAILING_LIST_MULTI -1,
  RCVD_IN_DNSWL_HI -5, LANGUAGES enda, BAYES_USED global, SA_VERSION 3.4.0
X-Spam-source: IP='209.132.180.67', Host='vger.kernel.org', Country='US',
  FromHeader='com', MailFrom='org'
X-Spam-charsets: 
X-Resolved-to: greg@kroah.com
X-Delivered-to: greg@kroah.com
X-Mail-from: stable-owner@vger.kernel.org
ARC-Seal: i=1; a=rsa-sha256; cv=none; d=messagingengine.com; s=fm2; t=
    1525306028; b=I1WXoobW1mwhRbpxIyii49Sfresvu+CK7Go3/DuwlujIpv038l
    28iofw/nwag3hH7dfqQ9FgRtllVBrHfhUU4wGm2HWpH26uliozQJpPh3Jr0EQZXT
    pxWtoWnoFcGJxn0j5xBRI1zuCcmyHHHfy4sN5L2fPqXP/LxZPemzgCjXpMt2j+Cy
    3knpvF2UxoLxvDmxMYkYYc1WXXzgBInv/0haX1k+Q3qI9Crc8qj2ZTGWYr4JDYEn
    6NA9sW7caa79KyCxnRVytkCeKvQ+B7raonZoz3EqYnIrnspmHXSykOyzRUlOedT7
    QJjwyzDW4jcBbTf9CvgIZ/5G+3aBimJ4/1Vg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=
    messagingengine.com; h=from:to:cc:subject:date:message-id:sender
    :list-id; s=fm2; t=1525306028; bh=lgrhnNE86gQ6sMYXn+4YR9kgOMo8pK
    aYL4yoHZIzgC4=; b=ABUoNhDh97a0nTX/sESxKFwMs7lN4G0uAGH4N76oSLgejS
    pjmohJnDLauH316tNNJwYK9Pd79irRgrGXX9BzXKU/SN9p6z1qBpJn8DHY7xsM++
    QgyBGYK1/+vMaUVtXtV6jc8Kwqm3jR9vScTlJzPC5LwxcolvZQKXq7ESjQ0R9Z0r
    GzqUUFyMe5AldoWaO4EOSBaxWPNJ0c2L4VJgKez4dMdDNH1S80Bwylej/nBsJsKL
    6xRAIBY7ox8NfYoICyJuYBH7NUg9LOlMBedJq7LiQ5MS2HPa3H8qrMOUZXuD6Vc1
    X+2KWrBgBQ0ACRXOtJAKZ8SJCju3wXne2PXfRNag==
ARC-Authentication-Results: i=1; mx4.messagingengine.com; arc=none (no signatures found);
    dkim=pass (2048-bit rsa key sha256) header.d=google.com
    header.i=@google.com header.b=djr0hvTe x-bits=2048 x-keytype=rsa
    x-algorithm=sha256 x-selector=20161025;
    dmarc=pass (p=reject,has-list-id=yes,d=none) header.from=google.com;
    iprev=pass policy.iprev=209.132.180.67 (vger.kernel.org);
    spf=none smtp.mailfrom=stable-owner@vger.kernel.org
    smtp.helo=vger.kernel.org;
    x-aligned-from=fail;
    x-cm=none score=0;
    x-google-dkim=pass (2048-bit rsa key) header.d=1e100.net
    header.i=@1e100.net header.b=ls/rFwgt;
    x-ptr=pass x-ptr-helo=vger.kernel.org x-ptr-lookup=vger.kernel.org;
    x-return-mx=pass smtp.domain=vger.kernel.org smtp.result=pass
    smtp_org.domain=kernel.org smtp_org.result=pass smtp_is_org_domain=no
    header.domain=google.com header.result=pass header_is_org_domain=yes;
    x-vs=clean score=-100 state=0
Authentication-Results: mx4.messagingengine.com;
    arc=none (no signatures found);
    dkim=pass (2048-bit rsa key sha256) header.d=google.com
      header.i=@google.com header.b=djr0hvTe x-bits=2048 x-keytype=rsa
      x-algorithm=sha256 x-selector=20161025;
    dmarc=pass (p=reject,has-list-id=yes,d=none) header.from=google.com;
    iprev=pass policy.iprev=209.132.180.67 (vger.kernel.org);
    spf=none smtp.mailfrom=stable-owner@vger.kernel.org
      smtp.helo=vger.kernel.org;
    x-aligned-from=fail;
    x-cm=none score=0;
    x-google-dkim=pass (2048-bit rsa key) header.d=1e100.net
      header.i=@1e100.net header.b=ls/rFwgt;
    x-ptr=pass x-ptr-helo=vger.kernel.org x-ptr-lookup=vger.kernel.org;
    x-return-mx=pass smtp.domain=vger.kernel.org smtp.result=pass
      smtp_org.domain=kernel.org smtp_org.result=pass smtp_is_org_domain=no
      header.domain=google.com header.result=pass header_is_org_domain=yes;
    x-vs=clean score=-100 state=0
X-ME-VSCategory: clean
X-CM-Envelope: MS4wfEhO00Gn5wpwqwnLrn13fZH5d42wkzZJiEFzHJV1MwiWl06JcHlutVp71jywbovTbWPYqSe+vnjPBYO1hG3m371JFwvoyYRGkMAfflKOWq3tWp/lWAuY
    Mzsk3AvgA5XfwZkUKqt/6hCsNTI5Y+llHRtidImOaj2BlINH9gIcPZCfgTg85jcepDMaadKt8M3jozyW37ct9cd9ByL4Ld3KVS8oA/4h1rYeez/WK+m+v7Dv
X-CM-Analysis: v=2.3 cv=JLoVTfCb c=1 sm=1 tr=0 a=UK1r566ZdBxH71SXbqIOeA==:117
    a=UK1r566ZdBxH71SXbqIOeA==:17 a=xqWC_Br6kY4A:10 a=VUJBJC2UJ8kA:10
    a=LpQP-O61AAAA:8 a=1XWaLZrsAAAA:8 a=VwQbUJbxAAAA:8 a=BIApdS2Zcw547OSZKX0A:9
    a=pioyyrs4ZptJ924tMmac:22 a=AjGcO6oz07-iQ99wixmX:22
X-ME-CMScore: 0
X-ME-CMCategory: none
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1751841AbeECAHH (ORCPT <rfc822;greg@kroah.com>);
        Wed, 2 May 2018 20:07:07 -0400
Received: from mail-pf0-f196.google.com ([209.85.192.196]:37693 "EHLO
        mail-pf0-f196.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1751803AbeECAHG (ORCPT
        <rfc822;stable@vger.kernel.org>); Wed, 2 May 2018 20:07:06 -0400
X-Google-Smtp-Source: AB8JxZrMJTfMM7v7WkXVu0I8glEpCdkTvwIU/YfNs2gR6gurcLWn3gnkG5LFYnr5jwEbfDzM2dnO0Q==
From: Daniel Rosenberg <drosen@google.com>
To: Sumit Semwal <sumit.semwal@linaro.org>,
        linux-kernel@vger.kernel.org
Cc: Gustavo Padovan <gustavo@padovan.org>, linux-media@vger.kernel.org,
        linaro-mm-sig@lists.linaro.org, dri-devel@lists.freedesktop.org,
        kernel-team@android.com, Daniel Rosenberg <drosen@google.com>,
        Divya Ponnusamy <pdivya@codeaurora.org>,
        stable <stable@vger.kernel.org>
Subject: [PATCH] drivers: dma-buf: Change %p to %pK in debug messages
Date: Wed,  2 May 2018 17:03:00 -0700
Message-Id: <20180503000300.90083-1-drosen@google.com>
X-Mailer: git-send-email 2.17.0.441.gb46fe60e1d-goog
Sender: stable-owner@vger.kernel.org
X-Mailing-List: stable@vger.kernel.org
X-getmail-retrieved-from-mailbox: INBOX
X-Mailing-List: linux-kernel@vger.kernel.org
List-ID: <linux-kernel.vger.kernel.org>

The format specifier %p can leak kernel addresses
while not valuing the kptr_restrict system settings.
Use %pK instead of %p, which also evaluates whether
kptr_restrict is set.

Signed-off-by: Divya Ponnusamy <pdivya@codeaurora.org>
Signed-off-by: Daniel Rosenberg <drosen@google.com>
Cc: stable <stable@vger.kernel.org>
---
 drivers/dma-buf/sync_debug.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/dma-buf/sync_debug.c b/drivers/dma-buf/sync_debug.c
index c4c8ecb24aa9..d8d340542a79 100644
--- a/drivers/dma-buf/sync_debug.c
+++ b/drivers/dma-buf/sync_debug.c
@@ -133,7 +133,7 @@ static void sync_print_sync_file(struct seq_file *s,
 	char buf[128];
 	int i;
 
-	seq_printf(s, "[%p] %s: %s\n", sync_file,
+	seq_printf(s, "[%pK] %s: %s\n", sync_file,
 		   sync_file_get_name(sync_file, buf, sizeof(buf)),
 		   sync_status_str(dma_fence_get_status(sync_file->fence)));
 
-- 
2.17.0.441.gb46fe60e1d-goog

