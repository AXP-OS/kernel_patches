From 851a03f61d90566e37408240b2f71ed34f8cc73a Mon Sep 17 00:00:00 2001
From: Vinayak Menon <vinmenon@codeaurora.org>
Date: Wed, 30 Dec 2020 11:23:26 +0530
Subject: mm: process_reclaim: pass pid struct instead of tgid

Pass pid struct instead of tgid to the reclaim notifier so that
notifier users need not worry on pid reuse issues.

Change-Id: Ifd11937da75547c3b0ddecc19ecad1e488a86962
Signed-off-by: Vinayak Menon <vinmenon@codeaurora.org>
---
 fs/proc/task_mmu.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/fs/proc/task_mmu.c b/fs/proc/task_mmu.c
index 6e3057e..b4a6e79 100644
--- a/fs/proc/task_mmu.c
+++ b/fs/proc/task_mmu.c
@@ -1821,7 +1821,7 @@ struct reclaim_param reclaim_task_nomap(struct task_struct *task,
 		goto out;
 	down_read(&mm->mmap_sem);
 
-	proc_reclaim_notify(task_tgid_nr(task), (void *)&rp);
+	proc_reclaim_notify((unsigned long)task_pid(task), (void *)&rp);
 
 	up_read(&mm->mmap_sem);
 	mmput(mm);
-- 
cgit v1.1

