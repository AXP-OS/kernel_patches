From a910e9cb6cde077646c391e206f1fed3a5f58f06 Mon Sep 17 00:00:00 2001
From: Aditya Sathish <asathish@codeaurora.org>
Date: Fri, 22 Jan 2021 21:19:08 +0530
Subject: qcacmn: Avoid checking extcaps byte if equal to IE len

Reading extcaps from the scan entry currently checks if the byte
to be accessed is less than the length of the IE. Following this,
it will attempt to access the extcap IE using the requested byte
as the index.

Avoid accessing the extcap IE if the byte is greater than one less
than the ie_len (since indexing starts from zero).

CRs-Fixed: 2856212
Change-Id: Ie357edcd6095570c05871af657381c287e92504e
---
 umac/scan/dispatcher/inc/wlan_scan_utils_api.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/umac/scan/dispatcher/inc/wlan_scan_utils_api.h b/umac/scan/dispatcher/inc/wlan_scan_utils_api.h
index 579ec76..a19a3ca 100644
--- a/umac/scan/dispatcher/inc/wlan_scan_utils_api.h
+++ b/umac/scan/dispatcher/inc/wlan_scan_utils_api.h
@@ -1349,7 +1349,7 @@ util_scan_entry_get_extcap(struct scan_cache_entry *scan_entry,
 	if (!ext_cap)
 		return QDF_STATUS_E_NULL_VALUE;
 
-	if (ext_cap->ext_cap_len < ext_caps_byte)
+	if (ext_cap->ext_cap_len <= ext_caps_byte)
 		return QDF_STATUS_E_NULL_VALUE;
 
 	*extcap_value =
-- 
cgit v1.1

