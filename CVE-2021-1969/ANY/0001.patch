From 88f51782b924b229104e3c399475979c9f1586e4 Mon Sep 17 00:00:00 2001
From: Jilai Wang <jilaiw@codeaurora.org>
Date: Wed, 16 Dec 2020 10:00:12 -0500
Subject: msm: npu: memset npu_kevent to prevent leak stack information

npu_kevent will be copied to user buffer, so it is possible that
user will be able to access some stack memory via the uninitialized
padding data. This change is to use memset to make sure this stack
information won't be leaked.

Change-Id: I77acafe11e67093f17906176720508674e1d35e8
Signed-off-by: Jilai Wang <jilaiw@codeaurora.org>
---
 drivers/media/platform/msm/npu/npu_mgr.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/media/platform/msm/npu/npu_mgr.c b/drivers/media/platform/msm/npu/npu_mgr.c
index d292126..08f0e2c 100644
--- a/drivers/media/platform/msm/npu/npu_mgr.c
+++ b/drivers/media/platform/msm/npu/npu_mgr.c
@@ -730,6 +730,7 @@ static void app_msg_proc(struct npu_host_ctx *host_ctx, uint32_t *msg)
 	struct npu_kevent kevt;
 	struct npu_device *npu_dev = host_ctx->npu_dev;
 
+	memset(&kevt, 0, sizeof(kevt));
 	msg_id = msg[1];
 	switch (msg_id) {
 	case NPU_IPC_MSG_EXECUTE_DONE:
-- 
cgit v1.1

