From 8bbe418836192817143685077cfca76b92811a6f Mon Sep 17 00:00:00 2001
From: Prakruthi Deepak Heragu <pheragu@codeaurora.org>
Date: Fri, 3 Sep 2021 18:05:52 -0700
Subject: qcom_wdt_core: Validate the input parameters of qcom_wdt_register

Ensure that the input parameters of qcom_wdt_register is checked before
proceeding as this could cause NULL pointer dereferences.

Change-Id: I29e7eee946fb9fe0ba7fe75b96acedff7deab4bd
Signed-off-by: Prakruthi Deepak Heragu <pheragu@codeaurora.org>
---
 drivers/soc/qcom/qcom_wdt_core.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/soc/qcom/qcom_wdt_core.c b/drivers/soc/qcom/qcom_wdt_core.c
index 36ab96b..5d9b152 100644
--- a/drivers/soc/qcom/qcom_wdt_core.c
+++ b/drivers/soc/qcom/qcom_wdt_core.c
@@ -1003,6 +1003,11 @@ int qcom_wdt_register(struct platform_device *pdev,
 	struct md_region md_entry;
 	int ret;
 
+	if (!pdev || !wdog_dd || !wdog_dd_name) {
+		pr_err("wdt_register input incorrect\n");
+		return -EINVAL;
+	}
+
 	qcom_wdt_dt_to_pdata(pdev, wdog_dd);
 	wdog_data = wdog_dd;
 	wdog_dd->dev = &pdev->dev;
-- 
cgit v1.1

