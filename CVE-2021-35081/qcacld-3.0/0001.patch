From 21597765ae914c49cd81d95c5999784628a71ae2 Mon Sep 17 00:00:00 2001
From: VIJAY RAJ <vijaraj@codeaurora.org>
Date: Wed, 8 Sep 2021 12:01:32 +0530
Subject: qcacld-3.0: Fix buffer overflow in pe_filter_bcn_probe_frame()

In pe_filter_bcn_probe_frame(), the value of bcn_ssid.length
could be greater than WLAN_SSID_MAX_LEN.

Added a check to prevent possible buffer overflow

Change-Id: I4a5247e9ea8a1c14335935cbe0739fb21a34d1ef
CRs-Fixed: 3028274
---
 core/mac/src/pe/lim/lim_api.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/core/mac/src/pe/lim/lim_api.c b/core/mac/src/pe/lim/lim_api.c
index 19b0639..b5f9264 100644
--- a/core/mac/src/pe/lim/lim_api.c
+++ b/core/mac/src/pe/lim/lim_api.c
@@ -1121,6 +1121,9 @@ static bool pe_filter_bcn_probe_frame(struct mac_context *mac_ctx,
 			return false;
 
 		bcn_ssid.length = ssid_ie[1];
+		if (bcn_ssid.length > WLAN_SSID_MAX_LEN)
+			return false;
+
 		qdf_mem_copy(&bcn_ssid.ssId,
 			     &ssid_ie[2],
 			     bcn_ssid.length);
-- 
cgit v1.1

