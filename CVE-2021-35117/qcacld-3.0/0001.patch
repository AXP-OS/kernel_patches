From ef0f64fb81401bd7ea71d05f9416c57c3ab7937d Mon Sep 17 00:00:00 2001
From: Utkarsh Bhatnagar <ubhatnag@codeaurora.org>
Date: Tue, 14 Sep 2021 09:56:52 +0530
Subject: qcacld-3.0: Fix OOB case in pe_filter_bcn_probe_frame()

Fix OOB case in pe_filter_bcn_probe_frame() for IBSS.

Change-Id: I2838d6232a9c4c1368e51bc445f91724fa4ed0dd
CRs-Fixed: 3028360
---
 core/mac/src/pe/lim/lim_api.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/core/mac/src/pe/lim/lim_api.c b/core/mac/src/pe/lim/lim_api.c
index 35eba9e..2b93bb1 100644
--- a/core/mac/src/pe/lim/lim_api.c
+++ b/core/mac/src/pe/lim/lim_api.c
@@ -1292,7 +1292,7 @@ static bool pe_filter_bcn_probe_frame(tpAniSirGlobal mac_ctx,
 
 		ssid_ie = wlan_get_ie_ptr_from_eid(SIR_MAC_SSID_EID,
 				body + SIR_MAC_B_PR_SSID_OFFSET,
-				frame_len);
+				frame_len - SIR_MAC_B_PR_SSID_OFFSET);
 
 		if (!ssid_ie)
 			return false;
-- 
cgit v1.1

