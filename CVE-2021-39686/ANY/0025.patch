diff --git a/drivers/android/binder.c b/drivers/android/binder.c
index 39778af..962f320 100644
--- a/drivers/android/binder.c
+++ b/drivers/android/binder.c
@@ -2865,7 +2865,7 @@
 		size_t added_size;
 		int max_retries = 100;
 
-		security_task_getsecid(proc->tsk, &secid);
+		security_cred_getsecid(binder_get_cred(proc), &secid);
  retry_alloc:
 		ret = security_secid_to_secctx(secid, &secctx, &secctx_sz);
 		if (ret == -ENOMEM && max_retries-- > 0) {
diff --git a/include/linux/security.h b/include/linux/security.h
index 9af6bc4..a87cbac 100644
--- a/include/linux/security.h
+++ b/include/linux/security.h
@@ -1011,6 +1011,11 @@
 {
 }
 
+static inline void security_cred_getsecid(const struct cred *c, u32 *secid)
+{
+	*secid = 0;
+}
+
 static inline int security_kernel_act_as(struct cred *cred, u32 secid)
 {
 	return 0;
