From f0b0920c43f0744b6562bfa38278e38cb9c8b010 Mon Sep 17 00:00:00 2001
From: Will Huang <quic_wilhuang@quicinc.com>
Date: Tue, 29 Mar 2022 10:13:41 +0800
Subject: [PATCH] qcacld-2.0: Avoid OOB read in dot11fUnpackAssocResponse

Avoid OOB read in dot11fUnpackAssocResponse API. Modify
the check to nBuf-len > 1 to read another byte of pBufRemaining.
This ensures a read of at least 2 bytes since all IEs have
at least 2 bytes.

Change-Id: Ic6756c11c05e68f0af5227971ce8b16a6c7e012a
CRs-Fixed: 3144382
---
 CORE/MAC/src/include/dot11f.h          | 3 ++-
 CORE/SYS/legacy/src/utils/src/dot11f.c | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/CORE/MAC/src/include/dot11f.h b/CORE/MAC/src/include/dot11f.h
index 283aa77ba..9398b7f3d 100755
--- a/CORE/MAC/src/include/dot11f.h
+++ b/CORE/MAC/src/include/dot11f.h
@@ -1,5 +1,6 @@
 /*
  * Copyright (c) 2012-2021 The Linux Foundation. All rights reserved.
+ * Copyright (c) 2021-2022 Qualcomm Innovation Center, Inc. All rights reserved.
  *
  * Previously licensed under the ISC license by Qualcomm Atheros, Inc.
  *
@@ -32,7 +33,7 @@
   * \brief Structures, function prototypes & definitions
   * for working with 802.11 Frames
   * This file was automatically generated by 'framesc'
-  * Tue Oct 12 15:11:34 2021 from the following file(s):
+  * Mon Mar 28 16:59:27 2022 from the following file(s):
   *
   * dot11f.frms
   *
diff --git a/CORE/SYS/legacy/src/utils/src/dot11f.c b/CORE/SYS/legacy/src/utils/src/dot11f.c
index 386122b2a..79e245f65 100755
--- a/CORE/SYS/legacy/src/utils/src/dot11f.c
+++ b/CORE/SYS/legacy/src/utils/src/dot11f.c
@@ -1,5 +1,6 @@
 /*
  * Copyright (c) 2012-2021 The Linux Foundation. All rights reserved.
+ * Copyright (c) 2021-2022 Qualcomm Innovation Center, Inc. All rights reserved.
  *
  * Previously licensed under the ISC license by Qualcomm Atheros, Inc.
  *
@@ -30,7 +31,7 @@
   * \brief Structures, functions & definitions for
   * working with 802.11 Frames
   * This file was automatically generated by 'framesc'
-  * Tue Oct 12 15:11:34 2021 from the following file(s):
+  * Mon Mar 28 16:59:27 2022 from the following file(s):
   *
   * dot11f.frms
   *
-- 
GitLab

