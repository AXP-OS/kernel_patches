From 078d2d73b02d5327f7b7f9c896a9f735ddaf4364 Mon Sep 17 00:00:00 2001
From: Lakshman Chaluvaraju <lchalu@codeaurora.org>
Date: Tue, 8 Jun 2021 10:43:20 +0530
Subject: [PATCH] Asoc: check for invalid voice session id

Add check to return if session id is invalid.

Change-Id: Ida0e07b78657102a3bf6e73a1ca23c44ad112426
Signed-off-by: Lakshman Chaluvaraju <lchalu@codeaurora.org>
---
 asoc/msm-pcm-routing-v2.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/asoc/msm-pcm-routing-v2.c b/asoc/msm-pcm-routing-v2.c
index e01a5aab..6032ccd9 100644
--- a/asoc/msm-pcm-routing-v2.c
+++ b/asoc/msm-pcm-routing-v2.c
@@ -2363,6 +2363,11 @@ static void msm_pcm_routing_process_voice(u16 reg, u16 val, int set)
 
 	session_id = msm_pcm_routing_get_voc_sessionid(val);
 
+	if (!session_id) {
+		pr_err("%s: Invalid session_id %x\n", __func__, session_id);
+		return;
+	}
+
 	pr_debug("%s: FE DAI 0x%x session_id 0x%x\n",
 		__func__, val, session_id);
 
-- 
GitLab

