From 3e1c309625c3219f366d89a5db9256a054df9a03 Mon Sep 17 00:00:00 2001
From: Sunil Yellamelli <quic_syellame@quicinc.com>
Date: Tue, 12 Apr 2022 11:06:28 +0530
Subject: [PATCH] Asoc: check for invalid voice session id

Add check to return if session id is invalid.

Change-Id: Id156612a341a370529945aa7ac9ea01fb8796f4f
---
 4.0/asoc/msm-pcm-routing-v2.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/4.0/asoc/msm-pcm-routing-v2.c b/4.0/asoc/msm-pcm-routing-v2.c
index fdfd4ee8..5ba9ca07 100644
--- a/4.0/asoc/msm-pcm-routing-v2.c
+++ b/4.0/asoc/msm-pcm-routing-v2.c
@@ -2375,6 +2375,11 @@ static void msm_pcm_routing_process_voice(u16 reg, u16 val, int set)
 	pr_debug("%s: FE DAI 0x%x session_id 0x%x\n",
 		__func__, val, session_id);
 
+	if (!session_id) {
+		pr_err("%s: Invalid session_id %x\n", __func__, session_id);
+		return;
+	}
+
 	mutex_lock(&routing_lock);
 
 	if (set)
-- 
GitLab

