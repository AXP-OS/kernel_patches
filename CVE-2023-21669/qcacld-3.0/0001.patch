From 1363410a456acf0bf217eea374852018993f99c0 Mon Sep 17 00:00:00 2001
From: Wu Gao <quic_wugao@quicinc.com>
Date: Tue, 6 Dec 2022 16:31:04 +0800
Subject: [PATCH] qcacld-3.0: Fix OOB issue when access wma_find_vdev_by_addr

The function 'wma_find_vdev_by_addr' returns pointer to cdp_vdev, so
should avoid to comapre with QDF_STATUS_SUCCESS.

Change-Id: Ica53b5a6d6672ef6949918ffed1397d1c0fd1813
CRs-Fixed: 3346764
---
 core/wma/src/wma_mgmt.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/core/wma/src/wma_mgmt.c b/core/wma/src/wma_mgmt.c
index b11950a3765..7456601cd7c 100644
--- a/core/wma/src/wma_mgmt.c
+++ b/core/wma/src/wma_mgmt.c
@@ -1,5 +1,6 @@
 /*
  * Copyright (c) 2013-2020 The Linux Foundation. All rights reserved.
+ * Copyright (c) 2022 Qualcomm Innovation Center, Inc. All rights reserved.
  *
  * Permission to use, copy, modify, and/or distribute this software for
  * any purpose with or without fee is hereby granted, provided that the
@@ -4442,7 +4443,7 @@ int wma_form_rx_packet(qdf_nbuf_t buf,
 			if (status)
 				return status;
 		} else if (wma_find_vdev_by_addr(wma_handle, wh->i_addr1,
-					      &vdev_id) == QDF_STATUS_SUCCESS) {
+			   &vdev_id)) {
 			status = wma_check_and_process_rmf_frame(wma_handle,
 								 vdev_id,
 								 &wh,
-- 
GitLab

