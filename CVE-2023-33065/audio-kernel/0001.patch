From fdefe3b2520cf15798b67d4d290bbfad5153d894 Mon Sep 17 00:00:00 2001
From: Sandhya Mutha Naga Venkata <quic_smuthana@quicinc.com>
Date: Wed, 12 Apr 2023 12:34:26 +0530
Subject: [PATCH] dsp: q6core: Avoid OOB access in q6core

"num_services", a signed integer when compared
with constant results in conversion of signed integer
to max possible unsigned int value when "num_services"
is a negative value. This can lead to OOB read.
Fix is to handle this case.

Change-Id: Id6a8f150d9019c972a87f789e4c626337a97bfff
Signed-off-by: Soumya Managoli <quic_c_smanag@quicinc.com>
---
 dsp/q6core.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dsp/q6core.c b/dsp/q6core.c
index 83d4c2a00..06fdcae14 100644
--- a/dsp/q6core.c
+++ b/dsp/q6core.c
@@ -205,7 +205,7 @@ EXPORT_SYMBOL(q6core_send_uevent);
 static int parse_fwk_version_info(uint32_t *payload, uint16_t payload_size)
 {
 	size_t ver_size;
-	int num_services;
+	uint16_t num_services;
 
 	pr_debug("%s: Payload info num services %d\n",
 		 __func__, payload[4]);
-- 
GitLab

