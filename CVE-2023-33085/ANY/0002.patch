From ce4331ec45a34c12af33f006176ce782e3674230 Mon Sep 17 00:00:00 2001
From: Praveen koya <quic_pkoya@quicinc.com>
Date: Fri, 21 Jul 2023 18:58:14 +0530
Subject: [PATCH] soc: qcom: add buffer overflow check on AON rx_buffer.

Add buffer overflow check while accessing data buffer
received from AON.

Change-Id: I0472a0ad1e6edc3fe8102850fddacd89ceea4959
Signed-off-by: Praveen koya <quic_pkoya@quicinc.com>
---
 drivers/soc/qcom/slate_events_bridge.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/soc/qcom/slate_events_bridge.c b/drivers/soc/qcom/slate_events_bridge.c
index ebddd7c04b80f..261be187ff50e 100644
--- a/drivers/soc/qcom/slate_events_bridge.c
+++ b/drivers/soc/qcom/slate_events_bridge.c
@@ -1,6 +1,7 @@
 // SPDX-License-Identifier: GPL-2.0-only
 /*
  * Copyright (c) 2021, The Linux Foundation. All rights reserved.
+ * Copyright (c) 2023, Qualcomm Innovation Center, Inc. All rights reserved.
  */
 
 #include <linux/delay.h>
@@ -439,6 +440,10 @@ void seb_rx_msg(void *data, int len)
 	dev->seb_resp_cmplt = true;
 	wake_up(&dev->link_state_wait);
 	if (dev->wait_for_resp) {
+		if (len > SEB_GLINK_INTENT_SIZE) {
+			pr_err("Invalid seb rx buffer length\n");
+			return;
+		}
 		memcpy(dev->rx_buf, data, len);
 	} else {
 		/* Handle the event received from Slate */
-- 
GitLab

