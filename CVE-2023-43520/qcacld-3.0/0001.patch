From f92388d27db9a17230035b5e1bf5eb48c546b305 Mon Sep 17 00:00:00 2001
From: Amruta Kulkarni <quic_amrukulk@quicinc.com>
Date: Thu, 3 Aug 2023 09:53:44 -0700
Subject: [PATCH] qcacld-3.0: Avoid out of bound memcopy

While parsing the beacon t2lm ie, avoid out
of bound memcopy.

Change-Id: I2db28b2a17efe0e8dea328dc76a1a5d98e7555dc
CRs-Fixed: 3575335
---
 core/mac/src/sys/legacy/src/utils/src/parser_api.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/core/mac/src/sys/legacy/src/utils/src/parser_api.c b/core/mac/src/sys/legacy/src/utils/src/parser_api.c
index 11aa05e2f7c..842c2a359c2 100644
--- a/core/mac/src/sys/legacy/src/utils/src/parser_api.c
+++ b/core/mac/src/sys/legacy/src/utils/src/parser_api.c
@@ -3917,7 +3917,7 @@ sir_convert_assoc_resp_frame2_t2lm_struct(struct mac_context *mac,
 		ie[TAG_LEN_POS] = ar->t2lm_ie[i].num_data + 1;
 		ie[IDEXT_POS] = WLAN_EXTN_ELEMID_T2LM;
 		qdf_mem_copy(&ie[3], &ar->t2lm_ie[i].data[0],
-			     ar->t2lm_ie[i].num_data + 3);
+			     ar->t2lm_ie[i].num_data);
 		qdf_trace_hex_dump(QDF_MODULE_ID_PE, QDF_TRACE_LEVEL_DEBUG,
 				   &ie[0], ar->t2lm_ie[i].num_data + 3);
 		status = wlan_mlo_parse_t2lm_info(&ie[0], &t2lm);
@@ -5240,7 +5240,7 @@ sir_convert_beacon_frame2_t2lm_struct(tDot11fBeacon *bcn_frm,
 		ie[TAG_LEN_POS] = bcn_frm->t2lm_ie[i].num_data + 1;
 		ie[IDEXT_POS] = WLAN_EXTN_ELEMID_T2LM;
 		qdf_mem_copy(&ie[3], &bcn_frm->t2lm_ie[i].data[0],
-			     bcn_frm->t2lm_ie[i].num_data + 3);
+			     bcn_frm->t2lm_ie[i].num_data);
 		qdf_trace_hex_dump(QDF_MODULE_ID_PE, QDF_TRACE_LEVEL_DEBUG,
 				   &ie[0], bcn_frm->t2lm_ie[i].num_data + 3);
 		status = wlan_mlo_parse_t2lm_info(&ie[0], &t2lm);
-- 
GitLab

