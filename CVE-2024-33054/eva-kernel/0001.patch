From 76af94175140cc945a651f99481f8a9b2c0b789d Mon Sep 17 00:00:00 2001
From: Gopireddy Arunteja Reddy <quic_garuntej@quicinc.com>
Date: Mon, 8 Apr 2024 15:35:56 +0530
Subject: [PATCH] msm: eva: overflow issue in vm msq receiver function

OOB write in VM message Q receiver function.

Change-Id: I0d58b4443818d362abfde2dfce7e4076e893280d
Signed-off-by: Gopireddy Arunteja Reddy <quic_garuntej@quicinc.com>
---
 msm/eva/vm/cvp_vm_msgq.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/msm/eva/vm/cvp_vm_msgq.c b/msm/eva/vm/cvp_vm_msgq.c
index ea2c9b1..e910938 100644
--- a/msm/eva/vm/cvp_vm_msgq.c
+++ b/msm/eva/vm/cvp_vm_msgq.c
@@ -37,7 +37,7 @@ static int cvp_msgq_receiver(void *data)
 
 	while (true) {
 		rc = gh_msgq_recv(msgq_drv->config.handle, msg_ptr,
-			GH_MSGQ_MAX_MSG_SIZE_BYTES, &size, 0);
+			sizeof(*msg_ptr), &size, 0);
 
 		if (rc != 0 ) {
 			dprintk(CVP_ERR,
-- 
GitLab

